



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="SeqKit - a cross-platform and ultrafast toolkit for FASTA/Q file manipulation">
      
      
      
        <meta name="author" content="Wei Shen">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../files/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>FAQ - SeqKit - Ultrafast FASTA/Q kit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="manifest" type="application/manifest+json" href="../manifest.webmanifest" crossorigin="use-credentials">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-28948626-9", "bioinf.shenwei.me/seqkit")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="blue-grey">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#faq-on-fastaq-manipulations" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="SeqKit - Ultrafast FASTA/Q kit" aria-label="SeqKit - Ultrafast FASTA/Q kit" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SeqKit - Ultrafast FASTA/Q kit
            </span>
            <span class="md-header-nav__topic">
              
                FAQ
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/shenwei356/seqkit/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="SeqKit - Ultrafast FASTA/Q kit" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    SeqKit - Ultrafast FASTA/Q kit
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/shenwei356/seqkit/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Documents
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Documents
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../usage/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        FAQ
      </label>
    
    <a href="./" title="FAQ" class="md-nav__link md-nav__link--active">
      FAQ
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-data" class="md-nav__link">
    Example data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-produce-an-overview-of-fastq-files" class="md-nav__link">
    How to produce an overview of FASTQ files?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-get-gc-content-of-every-sequence-in-fastaq-file" class="md-nav__link">
    How to get GC content of every sequence in FASTA/Q file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-sequences-subset-from-fastaq-file-with-nameid-list-file" class="md-nav__link">
    How to extract sequences subset from FASTA/Q file with name/ID list file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-find-fastaq-sequences-containing-degenerate-bases-and-locate-them" class="md-nav__link">
    How to find FASTA/Q sequences containing degenerate bases and locate them?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-remove-duplicated-fastaq-records-with-same-sequences" class="md-nav__link">
    How to remove duplicated FASTA/Q records with same sequences?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-locate-motifsubsequenceenzyme-digest-site-in-fastaq-sequence" class="md-nav__link">
    How to locate motif/subsequence/enzyme digest site in FASTA/Q sequence?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-sort-huge-number-of-fasta-sequences-by-length" class="md-nav__link">
    How to sort huge number of FASTA sequences by length?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-split-fasta-sequences-according-to-information-in-header" class="md-nav__link">
    How to split FASTA sequences according to information in header?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-search-and-replace-fasta-header-with-known-character-strings-from-a-text-file" class="md-nav__link">
    How to search and replace FASTA header with known character strings from a text file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-paired-reads-from-two-paired-end-reads-file" class="md-nav__link">
    How to extract paired reads from two paired-end reads file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-concatenate-two-fasta-sequences-in-to-one" class="md-nav__link">
    How to concatenate two FASTA sequences in to one?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial/" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../benchmark/" title="Benchmark" class="md-nav__link">
      Benchmark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../note/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/shenwei356" title="More tools" class="md-nav__link">
      More tools
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-data" class="md-nav__link">
    Example data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-produce-an-overview-of-fastq-files" class="md-nav__link">
    How to produce an overview of FASTQ files?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-get-gc-content-of-every-sequence-in-fastaq-file" class="md-nav__link">
    How to get GC content of every sequence in FASTA/Q file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-sequences-subset-from-fastaq-file-with-nameid-list-file" class="md-nav__link">
    How to extract sequences subset from FASTA/Q file with name/ID list file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-find-fastaq-sequences-containing-degenerate-bases-and-locate-them" class="md-nav__link">
    How to find FASTA/Q sequences containing degenerate bases and locate them?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-remove-duplicated-fastaq-records-with-same-sequences" class="md-nav__link">
    How to remove duplicated FASTA/Q records with same sequences?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-locate-motifsubsequenceenzyme-digest-site-in-fastaq-sequence" class="md-nav__link">
    How to locate motif/subsequence/enzyme digest site in FASTA/Q sequence?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-sort-huge-number-of-fasta-sequences-by-length" class="md-nav__link">
    How to sort huge number of FASTA sequences by length?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-split-fasta-sequences-according-to-information-in-header" class="md-nav__link">
    How to split FASTA sequences according to information in header?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-search-and-replace-fasta-header-with-known-character-strings-from-a-text-file" class="md-nav__link">
    How to search and replace FASTA header with known character strings from a text file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-paired-reads-from-two-paired-end-reads-file" class="md-nav__link">
    How to extract paired reads from two paired-end reads file?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-concatenate-two-fasta-sequences-in-to-one" class="md-nav__link">
    How to concatenate two FASTA sequences in to one?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/shenwei356/seqkit/edit/master/docs/faq.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="faq-on-fastaq-manipulations">FAQ on FASTA/Q manipulations</h1>
<p><strong>This page was originally written as the section <a href="https://read.biostarhandbook.com/data/fastq-manipulation.html">FASTA/Q manipulations</a> of <a href="https://read.biostarhandbook.com/">The Biostar Handbook: A Beginner's Guide to Bioinformatics</a> (<a href="https://www.biostars.org/p/225812/">discussion on Biostars.org</a>)</strong>.</p>
<hr />
<p>This page illustrates common FASTA/Q manipulations using
<a href="http://bioinf.shenwei.me/seqkit/">SeqKit</a>.
Some other utilities, including <a href="http://bioinf.shenwei.me/csvtk/">csvtk</a> (CSV/TSV toolkit) and shell commands were also used.</p>
<p>Note: SeqKit seamlessly support FASTA and FASTQ formats both in their original form or
in stored in gzipped compressed format. We list FASTA or FASTQ depending on the more common
usage but you can always use it on the other type as well.</p>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

<ul>
<li><a href="#example-data">Example data</a></li>
<li><a href="#how-to-produce-an-overview-of-fastq-files">How to produce an overview of FASTQ files?</a></li>
<li><a href="#how-to-get-gc-content-of-every-sequence-in-fastaq-file">How to get GC content of every sequence in FASTA/Q file?</a></li>
<li><a href="#how-to-extract-sequences-subset-from-fastaq-file-with-nameid-list-file">How to extract sequences subset from FASTA/Q file with name/ID list file?</a></li>
<li><a href="#how-to-find-fastaq-sequences-containing-degenerate-bases-and-locate-them">How to find FASTA/Q sequences containing degenerate bases and locate them?</a></li>
<li><a href="#how-to-remove-duplicated-fastaq-records-with-same-sequences">How to remove duplicated FASTA/Q records with same sequences?</a></li>
<li><a href="#how-to-locate-motifsubsequenceenzyme-digest-site-in-fastaq-sequence">How to locate motif/subsequence/enzyme digest site in FASTA/Q sequence?</a></li>
<li><a href="#how-to-sort-huge-number-of-fasta-sequences-by-length">How to sort huge number of FASTA sequences by length?</a></li>
<li><a href="#how-to-split-fasta-sequences-according-to-information-in-header">How to split FASTA sequences according to information in header?</a></li>
<li><a href="#how-to-search-and-replace-fasta-header-with-known-character-strings-from-a-text-file">How to search and replace FASTA header with known character strings from a text file?</a></li>
<li><a href="#how-to-extract-paired-reads-from-two-paired-end-reads-file">How to extract paired reads from two paired-end reads file?</a></li>
<li><a href="#how-to-concatenate-two-fasta-sequences-in-to-one">How to concatenate two FASTA sequences in to one?</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<h2 id="example-data">Example data</h2>
<p>One FASTQ file (sample reads, 1M) and two FASTA files (Virus DNA and protein
sequences from NCBI RefSeq database, 60+40M) are used.</p>
<pre><code>wget http://data.biostarhandbook.com/reads/duplicated-reads.fq.gz
wget ftp://ftp.ncbi.nih.gov/refseq/release/viral/viral.1.1.genomic.fna.gz
wget ftp://ftp.ncbi.nih.gov/refseq/release/viral/viral.1.protein.faa.gz
</code></pre>
<h2 id="how-to-produce-an-overview-of-fastq-files">How to produce an overview of FASTQ files?</h2>
<p>Sequence format and type are automatically detected.</p>
<pre><code>$ seqkit stat *.gz
file                      format  type     num_seqs      sum_len  min_len   avg_len    max_len
duplicated-reads.fq.gz    FASTQ   DNA        15,000    1,515,000      101       101        101
viral.1.1.genomic.fna.gz  FASTA   DNA         7,048  203,325,120      200  28,848.6  2,473,870
viral.1.protein.faa.gz    FASTA   Protein   252,611   62,024,702        5     245.5      8,960
</code></pre>
<h2 id="how-to-get-gc-content-of-every-sequence-in-fastaq-file">How to get GC content of every sequence in FASTA/Q file?</h2>
<p><code>seqkit fx2tab</code> converts FASTA/Q to 3-column tabular format (1th: name/ID,
2nd: sequence, 3rd: quality), and can also provides
various information in new columns, including sequence length, GC content/GC skew, alphabet.</p>
<p>GC content:</p>
<pre><code>$ seqkit fx2tab --name --only-id --gc viral*.fna.gz
gi|526245010|ref|NC_021865.1|                   40.94
gi|460042095|ref|NC_020479.1|                   41.82
gi|526244636|ref|NC_021857.1|                   49.17
</code></pre>
<p>Custom bases (A, C and A+C):</p>
<pre><code>$ seqkit fx2tab -H -n -i -B a -B c -B ac viral.1.1.genomic.fna.gz
#name   seq     qual    a       c       ac
gi|526245010|ref|NC_021865.1|                   33.20   18.24   51.44
gi|460042095|ref|NC_020479.1|                   32.57   19.63   52.20
gi|526244636|ref|NC_021857.1|                   25.52   23.06   48.59
</code></pre>
<h2 id="how-to-extract-sequences-subset-from-fastaq-file-with-nameid-list-file">How to extract sequences subset from FASTA/Q file with name/ID list file?</h2>
<p>This is a frequently used manipulation. Let's create a sample ID list file,
which may also come from other way like mapping result.</p>
<pre><code>$ seqkit sample --proportion 0.001  duplicated-reads.fq.gz \
    | seqkit seq --name --only-id &gt; id.txt
</code></pre>
<p>ID list file:</p>
<pre><code>$ head id.txt
SRR1972739.2996
SRR1972739.3044
SRR1972739.3562
</code></pre>
<p>Searching by ID list file:</p>
<pre><code>$ seqkit grep --pattern-file id.txt duplicated-reads.fq.gz \
    &gt; duplicated-reads.subset.fq.gz
</code></pre>
<h2 id="how-to-find-fastaq-sequences-containing-degenerate-bases-and-locate-them">How to find FASTA/Q sequences containing degenerate bases and locate them?</h2>
<p><code>seqkit fx2tab</code> converts FASTA/Q to tabular format and can output the sequence
alphabet in a new column. And then text searching tools can be used to filter
the table.</p>
<pre><code>$ seqkit fx2tab -n -i -a viral.1.1.genomic.fna.gz \
    | csvtk -H -t grep -f 4 -r -i -p "[^ACGT]"
gi|446730228|ref|NC_019782.1|                   ACGNT
gi|557940284|ref|NC_022800.1|                   ACGKT
gi|564292828|ref|NC_023009.1|                   ACGNT
</code></pre>
<p>Long-option version of the command:</p>
<pre><code>$ seqkit fx2tab --name --only-id --alphabet  viral.1.1.genomic.fna.gz \
    | csvtk --no-header-row --tabs grep --fields 4 --use-regexp --ignore-case --pattern "[^ACGT]"
</code></pre>
<p>You can then exclude these sequences with <code>seqkit grep</code>:</p>
<pre><code># save the sequenece IDs.
$ seqkit fx2tab -n -i -a viral.1.1.genomic.fna.gz \
    | csvtk -H -t grep -f 4 -r -i -p "[^ACGT]" | csvtk -H -t cut -f 1 &gt; id2.txt

# search and exclude.
$ seqkit grep --pattern-file id2.txt --invert-match viral.1.1.genomic.fna.gz &gt; clean.fa
</code></pre>
<p>Or locate the degenerate bases, e.g, <code>N</code> and <code>K</code></p>
<pre><code>$ seqkit grep --pattern-file id2.txt viral.1.1.genomic.fna.gz \
    | seqkit locate --ignore-case --only-positive-strand --pattern K+ --pattern N+
seqID   patternName     pattern strand  start   end     matched
gi|564292828|ref|NC_023009.1|   N+      N+      +       87972   87972   N
gi|564292828|ref|NC_023009.1|   N+      N+      +       100983  100983  N
gi|557307918|ref|NC_022755.1|   K+      K+      +       1788    1788    K
gi|557307918|ref|NC_022755.1|   K+      K+      +       4044    4044    K
gi|589287065|ref|NC_023585.1|   K+      K+      +       28296   28296   K
gi|590911929|ref|NC_023639.1|   N+      N+      +       741654  741753  NNNNNNNNNNNNNNNNNNNNNNNNNNN
</code></pre>
<h2 id="how-to-remove-duplicated-fastaq-records-with-same-sequences">How to remove duplicated FASTA/Q records with same sequences?</h2>
<pre><code>$ seqkit rmdup --by-seq --ignore-case duplicated-reads.fq.gz &gt; duplicated-reads.uniq.fq.gz
</code></pre>
<p>If the FASTA/Q file is very large, please switch on flag <code>-m/--md5</code>,
which use MD5 instead of original seqs to reduce memory usage
when comparing by sequences.</p>
<p>You can also deduplicate according to sequence ID (default) or
full name (<code>--by-name</code>).</p>
<h2 id="how-to-locate-motifsubsequenceenzyme-digest-site-in-fastaq-sequence">How to locate motif/subsequence/enzyme digest site in FASTA/Q sequence?</h2>
<p>Related posts:
<a href="https://www.biostars.org/p/204658/">Question: Count and location of strings in fastq file reads</a>,
<a href="https://www.biostars.org/p/221325/">Question: Finding TATAWAA in sequence</a>
.</p>
<p>Assuming a list of motifs (enzyme digest sites) in FASTA format to be located:</p>
<pre><code>$ cat enzymes.fa
&gt;EcoRI
GAATTC
&gt;MmeI
TCCRAC
&gt;SacI
GAGCTC
&gt;XcmI
CCANNNNNNNNNTGG
</code></pre>
<p>Flag <code>--degenerate</code> is on because patterns contain degenerate bases. Command:</p>
<pre><code>$ seqkit locate --degenerate --ignore-case --pattern-file enzymes.fa viral.1.1.genomic.fna.gz
</code></pre>
<p>Sample output (simplified and reformated by <code>csvtk -t uniq -f 3 | csvtk -t pretty</code>)</p>
<pre><code>seqID                           patternName   pattern           strand   start   end     matched
gi|526245010|ref|NC_021865.1|   MmeI          TCCRAC            +        1816    1821    TCCGAC
gi|526245010|ref|NC_021865.1|   SacI          GAGCTC            +        19506   19511   GAGCTC
gi|526245010|ref|NC_021865.1|   XcmI          CCANNNNNNNNNTGG   +        2221    2235    CCATATTTAGTGTGG
</code></pre>
<h2 id="how-to-sort-huge-number-of-fasta-sequences-by-length">How to sort huge number of FASTA sequences by length?</h2>
<p>Sorting FASTA file in order of sequence size (small to large).</p>
<pre><code>$ seqkit sort --by-length viral.1.1.genomic.fna.gz &gt; viral.1.1.genomic.sorted.fa
</code></pre>
<p>If the files are too big, use flag <code>--two-pass</code> which consumes lesser memory.</p>
<pre><code>$ seqkit sort --by-length --two-pass viral.1.1.genomic.fna.gz &gt; viral.1.1.genomic.sorted.fa
</code></pre>
<p>You can also sort by sequence ID (default), full header (<code>--by-name</code>) or
sequence content (<code>--by-seq</code>).</p>
<h2 id="how-to-split-fasta-sequences-according-to-information-in-header">How to split FASTA sequences according to information in header?</h2>
<p>Related posts:
<a href="https://www.biostars.org/p/223937/">Question: extract same all similar sequences in FASTA based on the header</a>
.</p>
<p>For example, FASTA header line of <code>viral.1.protein.faa.gz</code> contain species name
in square brackets.</p>
<p>Overview of FASTA Headers:</p>
<pre><code>$ seqkit head -n 3 viral.1.protein.faa.gz | seqkit seq --name
gi|526245011|ref|YP_008320337.1| terminase small subunit [Paenibacillus phage phiIBB_Pl23]
gi|526245012|ref|YP_008320338.1| terminase large subunit [Paenibacillus phage phiIBB_Pl23]
gi|526245013|ref|YP_008320339.1| portal protein [Paenibacillus phage phiIBB_Pl23]
</code></pre>
<p><code>seqkit split</code> can split FASTA/Q files according to ID, number of parts, size
of every parts, and sequence region. In this case, we'll split according to
sequence ID (species names) which can be specified by flag <code>--id-regexp</code>.</p>
<p>Default ID:</p>
<pre><code>$ seqkit head -n 3 viral.1.protein.faa.gz \
    | seqkit seq --name --only-id
gi|526245011|ref|YP_008320337.1|
gi|526245012|ref|YP_008320338.1|
gi|526245013|ref|YP_008320339.1|
</code></pre>
<p>New ID:</p>
<pre><code>$ seqkit head -n 3 viral.1.protein.faa.gz \
    | seqkit seq --name --only-id --id-regexp "\[(.+)\]"
Paenibacillus phage phiIBB_Pl23
Paenibacillus phage phiIBB_Pl23
Paenibacillus phage phiIBB_Pl23
</code></pre>
<p>Split:</p>
<pre><code>$ seqkit split --by-id --id-regexp "\[(.+)\]" viral.1.protein.faa.gz
</code></pre>
<h2 id="how-to-search-and-replace-fasta-header-with-known-character-strings-from-a-text-file">How to search and replace FASTA header with known character strings from a text file?</h2>
<p>Related posts:
<a href="https://www.biostars.org/p/221962/">Question: Replace names in FASTA file with a known character string from a text file</a>,
<a href="https://www.biostars.org/p/205044/">Question: Fasta header, search and replace...?</a>
.</p>
<p><code>seqKit replace</code> can find substrings in FASTA/Q header with regular expression
and replace them with strings or corresponding values of found substrings
provided by the tab-delimited key-value file.</p>
<p>For example, to unify names of protein with unknown functions, we want to
rename "hypothetical" to "putative" in lower case.
The replacing rules are listed below in tab-delimited file:</p>
<pre><code>$ cat changes.tsv
Hypothetical    putative
hypothetical    putative
Putative        putative
</code></pre>
<p>Overview the FASTA headers containing "hypothetical":</p>
<pre><code>$ seqkit grep --by-name --use-regexp --ignore-case --pattern hypothetical viral.1.protein.faa.gz \
    | seqkit head -n 3 | seqkit seq --name
gi|526245016|ref|YP_008320342.1| hypothetical protein IBBPl23_06 [Paenibacillus phage phiIBB_Pl23]
gi|526245019|ref|YP_008320345.1| hypothetical protein IBBPl23_09 [Paenibacillus phage phiIBB_Pl23]
gi|526245020|ref|YP_008320346.1| hypothetical protein IBBPl23_10 [Paenibacillus phage phiIBB_Pl23]
</code></pre>
<p>A regular expression, <code>^([^ ]+ )(\w+)</code>, was used to specify the key to be
replaced, which is the first word after sequence ID in this case. Note that we also
capture the ID (<code>^([^ ]+ )</code>) so we can restore it in "replacement" with
capture variable  <code>${1}</code> (robuster than <code>$1</code>).
And flag <code>-I/--key-capt-idx</code> (default: 1) is set to 2 because the key <code>(\w+)</code>
is the second captured match. Command:</p>
<pre><code>$ seqkit replace --kv-file changes.tsv --pattern "^([^ ]+ )(\w+) " \
    --replacement "\${1}{kv} " --key-capt-idx 2 --keep-key viral.1.protein.faa.gz &gt; renamed.fa
</code></pre>
<h2 id="how-to-extract-paired-reads-from-two-paired-end-reads-file">How to extract paired reads from two paired-end reads file?</h2>
<p>Use <a href="https://bioinf.shenwei.me/seqkit/usage/#pair">seqkit pair</a>.</p>
<h2 id="how-to-concatenate-two-fasta-sequences-in-to-one">How to concatenate two FASTA sequences in to one?</h2>
<p>Related posts: <a href="https://www.biostars.org/p/231806/">Combining two fasta sequences into one</a></p>
<p>Data (not in same order):</p>
<pre><code>$ cat 1.fa
&gt;seq1
aaaaa
&gt;seq2
ccccc
&gt;seq3
ggggg

$ cat 2.fa
&gt;seq3
TTTTT
&gt;seq2
GGGGG
&gt;seq1
CCCCC
</code></pre>
<p>Just one command:</p>
<pre><code>$ seqkit concat 1.fa 2.fa
&gt;seq1
aaaaaCCCCC
&gt;seq2
cccccGGGGG
&gt;seq3
gggggTTTTT
</code></pre>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../usage/" title="Usage" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Usage
              </span>
            </div>
          </a>
        
        
          <a href="../tutorial/" title="Tutorial" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Tutorial
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>