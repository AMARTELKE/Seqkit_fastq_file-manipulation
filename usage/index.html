



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="SeqKit - a cross-platform and ultrafast toolkit for FASTA/Q file manipulation">
      
      
      
        <meta name="author" content="Wei Shen">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../files/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Usage - SeqKit - Ultrafast FASTA/Q kit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="manifest" type="application/manifest+json" href="../manifest.webmanifest" crossorigin="use-credentials">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-28948626-9", "bioinf.shenwei.me/seqkit")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="blue-grey">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#usage-and-examples" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="SeqKit - Ultrafast FASTA/Q kit" aria-label="SeqKit - Ultrafast FASTA/Q kit" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SeqKit - Ultrafast FASTA/Q kit
            </span>
            <span class="md-header-nav__topic">
              
                Usage
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/shenwei356/seqkit/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="SeqKit - Ultrafast FASTA/Q kit" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    SeqKit - Ultrafast FASTA/Q kit
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/shenwei356/seqkit/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Documents
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Documents
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Usage
      </label>
    
    <a href="./" title="Usage" class="md-nav__link md-nav__link--active">
      Usage
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details-and-guides-for-use" class="md-nav__link">
    Technical details and guides for use
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastaq-format-parsing" class="md-nav__link">
    FASTA/Q format parsing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-formats-and-types" class="md-nav__link">
    Sequence formats and types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-id" class="md-nav__link">
    Sequence ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fasta-index" class="md-nav__link">
    FASTA index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallelization-of-cpu-intensive-jobs" class="md-nav__link">
    Parallelization of CPU intensive jobs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-occupation" class="md-nav__link">
    Memory occupation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reproducibility" class="md-nav__link">
    Reproducibility
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqkit" class="md-nav__link">
    seqkit
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    Datasets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seq" class="md-nav__link">
    seq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subseq" class="md-nav__link">
    subseq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sliding" class="md-nav__link">
    sliding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    stats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faidx" class="md-nav__link">
    faidx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#watch" class="md-nav__link">
    watch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sana" class="md-nav__link">
    sana
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fq2fa" class="md-nav__link">
    fq2fa
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fx2tab-tab2fx" class="md-nav__link">
    fx2tab &amp; tab2fx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convert" class="md-nav__link">
    convert
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#translate" class="md-nav__link">
    translate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grep" class="md-nav__link">
    grep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locate" class="md-nav__link">
    locate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fish" class="md-nav__link">
    fish
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amplicon" class="md-nav__link">
    amplicon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duplicate" class="md-nav__link">
    duplicate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmdup" class="md-nav__link">
    rmdup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common" class="md-nav__link">
    common
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split" class="md-nav__link">
    split
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split2" class="md-nav__link">
    split2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample" class="md-nav__link">
    sample
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#head" class="md-nav__link">
    head
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#range" class="md-nav__link">
    range
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace" class="md-nav__link">
    replace
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rename" class="md-nav__link">
    rename
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    restart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concat" class="md-nav__link">
    concat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mutate" class="md-nav__link">
    mutate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shuffle" class="md-nav__link">
    shuffle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sort" class="md-nav__link">
    sort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bam" class="md-nav__link">
    bam
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fish_1" class="md-nav__link">
    fish
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sana_1" class="md-nav__link">
    sana
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#watch_1" class="md-nav__link">
    watch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genautocomplete" class="md-nav__link">
    genautocomplete
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial/" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../benchmark/" title="Benchmark" class="md-nav__link">
      Benchmark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../note/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/shenwei356" title="More tools" class="md-nav__link">
      More tools
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details-and-guides-for-use" class="md-nav__link">
    Technical details and guides for use
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastaq-format-parsing" class="md-nav__link">
    FASTA/Q format parsing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-formats-and-types" class="md-nav__link">
    Sequence formats and types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-id" class="md-nav__link">
    Sequence ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fasta-index" class="md-nav__link">
    FASTA index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallelization-of-cpu-intensive-jobs" class="md-nav__link">
    Parallelization of CPU intensive jobs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-occupation" class="md-nav__link">
    Memory occupation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reproducibility" class="md-nav__link">
    Reproducibility
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqkit" class="md-nav__link">
    seqkit
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    Datasets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seq" class="md-nav__link">
    seq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subseq" class="md-nav__link">
    subseq
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sliding" class="md-nav__link">
    sliding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    stats
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faidx" class="md-nav__link">
    faidx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#watch" class="md-nav__link">
    watch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sana" class="md-nav__link">
    sana
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fq2fa" class="md-nav__link">
    fq2fa
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fx2tab-tab2fx" class="md-nav__link">
    fx2tab &amp; tab2fx
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convert" class="md-nav__link">
    convert
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#translate" class="md-nav__link">
    translate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grep" class="md-nav__link">
    grep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locate" class="md-nav__link">
    locate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fish" class="md-nav__link">
    fish
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amplicon" class="md-nav__link">
    amplicon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duplicate" class="md-nav__link">
    duplicate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rmdup" class="md-nav__link">
    rmdup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common" class="md-nav__link">
    common
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split" class="md-nav__link">
    split
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split2" class="md-nav__link">
    split2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample" class="md-nav__link">
    sample
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#head" class="md-nav__link">
    head
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#range" class="md-nav__link">
    range
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace" class="md-nav__link">
    replace
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rename" class="md-nav__link">
    rename
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    restart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concat" class="md-nav__link">
    concat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mutate" class="md-nav__link">
    mutate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shuffle" class="md-nav__link">
    shuffle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sort" class="md-nav__link">
    sort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bam" class="md-nav__link">
    bam
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fish_1" class="md-nav__link">
    fish
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sana_1" class="md-nav__link">
    sana
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#watch_1" class="md-nav__link">
    watch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genautocomplete" class="md-nav__link">
    genautocomplete
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/shenwei356/seqkit/edit/master/docs/usage.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="usage-and-examples">Usage and Examples</h1>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->

<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#technical-details-and-guides-for-use">Technical details and guides for use</a></li>
<li><a href="#seqkit">seqkit</a></li>
</ul>
<p><strong>Sequence and subsequence</strong></p>
<ul>
<li><a href="#seq">seq</a></li>
<li><a href="#subseq">subseq</a></li>
<li><a href="#sliding">sliding</a></li>
<li><a href="#stats">stats</a></li>
<li><a href="#faidx">faidx</a></li>
<li><a href="#watch">watch</a></li>
<li><a href="#sana">sana</a></li>
</ul>
<p><strong>Format conversion</strong></p>
<ul>
<li><a href="#fq2fa">fq2fa</a></li>
<li><a href="#fx2tab--tab2fx">fx2tab &amp; tab2fx</a></li>
<li><a href="#convert">convert</a></li>
<li><a href="#translate">translate</a></li>
</ul>
<p><strong>Searching</strong></p>
<ul>
<li><a href="#grep">grep</a></li>
<li><a href="#locate">locate</a></li>
<li><a href="#fish">fish</a></li>
<li><a href="#amplicon">amplicon</a></li>
</ul>
<p><strong>BAM processing and monitoring</strong></p>
<ul>
<li><a href="#bam">bam</a></li>
</ul>
<p><strong>Set operations</strong></p>
<ul>
<li><a href="#head">head</a></li>
<li><a href="#range">range</a></li>
<li><a href="#sample">sample</a></li>
<li><a href="#rmdup">rmdup</a></li>
<li><a href="#duplicate">duplicate</a></li>
<li><a href="#common">common</a></li>
<li><a href="#split">split</a></li>
<li><a href="#split2">split2</a></li>
</ul>
<p><strong>Edit</strong></p>
<ul>
<li><a href="#replace">replace</a></li>
<li><a href="#rename">rename</a></li>
<li><a href="#restart">restart</a></li>
<li><a href="#concat">concat</a></li>
<li><a href="#mutate">mutate</a></li>
</ul>
<p><strong>Ordering</strong></p>
<ul>
<li><a href="#shuffle">shuffle</a></li>
<li><a href="#sort">sort</a></li>
</ul>
<p><strong>Misc</strong></p>
<ul>
<li><a href="#genautocomplete">genautocomplete</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<h2 id="technical-details-and-guides-for-use">Technical details and guides for use</h2>
<h3 id="fastaq-format-parsing">FASTA/Q format parsing</h3>
<p>SeqKit uses author's lightweight and high-performance bioinformatics packages
<a href="https://github.com/shenwei356/bio">bio</a> for FASTA/Q parsing,
which has <a href="https://github.com/shenwei356/bio#fastaq-parsing">high performance</a>
close to the
famous C lib <a href="https://github.com/attractivechaos/klib/">klib</a> (<a href="https://github.com/attractivechaos/klib/blob/master/kseq.h">kseq.h</a>).</p>
<p><img alt="" src="https://github.com/shenwei356/bio/raw/master/benchmark/benchmark.tsv.png" /></p>
<p><s>Seqkit calls <code>pigz</code> (much faster than <code>gzip</code>) or <code>gzip</code> to decompress .gz file if they are available.
So please <strong>install <a href="http://zlib.net/pigz/">pigz</a> to gain better parsing performance for gzipped data</strong>.</s>
Seqkit does not call <code>pigz</code> or <code>gzip</code> any more since v0.8.1,
Because it does not always increase the speed.
But you can still utilize <code>pigz</code> or <code>gzip</code> by <code>pigz -d -c seqs.fq.gz | seqkit xxx</code>.</p>
<p>Seqkit uses package <a href="https://github.com/klauspost/pgzip">pgzip</a> to write gzip file,
which is very fast (<strong>10X of <code>gzip</code>, 4X of <code>pigz</code></strong>) and the gzip file would be slighty larger.</p>
<h3 id="sequence-formats-and-types">Sequence formats and types</h3>
<p>SeqKit seamlessly support FASTA and FASTQ format.
Sequence format is automatically detected.
All subcommands except for <code>faidx</code> can handle both formats.
And only when some commands (<code>subseq</code>, <code>split</code>, <code>sort</code> and <code>shuffle</code>)
which utilise FASTA index to improve perfrmance for large files in two pass mode
(by flag <code>--two-pass</code>), only FASTA format is supported.</p>
<p>Sequence type (DNA/RNA/Protein) is automatically detected by leading subsequences
of the first sequences in file or STDIN. The length of the leading subsequences
is configurable by global flag <code>--alphabet-guess-seq-length</code> with default value
of 10000. If length of the sequences is less than that, whole sequences will
be checked.</p>
<h3 id="sequence-id">Sequence ID</h3>
<p>By default, most softwares, including <code>seqkit</code>, take the leading non-space
letters as sequence identifier (ID). For example,</p>
<table>
<thead>
<tr>
<th align="left">FASTA header</th>
<th align="left">ID</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">&gt;123456 gene name</td>
<td align="left">123456</td>
</tr>
<tr>
<td align="left">&gt;longname</td>
<td align="left">longname</td>
</tr>
<tr>
<td align="left">&gt;gi&#124;110645304&#124;ref&#124;NC_002516.2&#124; Pseudomona</td>
<td align="left">gi&#124;110645304&#124;ref&#124;NC_002516.2&#124;</td>
</tr>
</tbody>
</table>
<p>But for some sequences from NCBI,
e.g. <code>&gt;gi|110645304|ref|NC_002516.2| Pseudomona</code>, the ID is <code>NC_002516.2</code>.
In this case, we could set sequence ID parsing regular expression by global flag
<code>--id-regexp "\|([^\|]+)\| "</code> or just use flag <code>--id-ncbi</code>. If you want
the <code>gi</code> number, then use <code>--id-regexp "^gi\|([^\|]+)\|"</code>.</p>
<h3 id="fasta-index">FASTA index</h3>
<p>For some commands, including <code>subseq</code>, <code>split</code>, <code>sort</code> and <code>shuffle</code>,
when input files are (plain or gzipped) FASTA files,
FASTA index would be optional used for
rapid access of sequences and reducing memory occupation.</p>
<p>ATTENTION: the <code>.seqkit.fai</code> file created by SeqKit is a little different from <code>.fai</code> file
created by <code>samtools</code>. SeqKit uses full sequence head instead of just ID as key.</p>
<h3 id="parallelization-of-cpu-intensive-jobs">Parallelization of CPU intensive jobs</h3>
<p>The validation of sequences bases and complement process of sequences
are parallelized for large sequences.</p>
<p>Parsing of line-based files, including BED/GFF file and ID list file are also parallelized.</p>
<p>The Parallelization is implemented by multiple goroutines in golang
 which are similar to but much
lighter weight than threads. The concurrency number is configurable with global
flag <code>-j</code> or <code>--threads</code> (default value: 1 for single-CPU PC, 2 for others).</p>
<h3 id="memory-occupation">Memory occupation</h3>
<p>Most of the subcommands do not read whole FASTA/Q records in to memory,
including <code>stat</code>, <code>fq2fa</code>, <code>fx2tab</code>, <code>tab2fx</code>, <code>grep</code>, <code>locate</code>, <code>replace</code>,
 <code>seq</code>, <code>sliding</code>, <code>subseq</code>.</p>
<p>Note that when using <code>subseq --gtf | --bed</code>, if the GTF/BED files are too
big, the memory usage will increase.
You could use <code>--chr</code> to specify chromesomes and <code>--feature</code> to limit features.</p>
<p>Some subcommands need to store sequences or heads in memory, but there are
strategy to reduce memory occupation, including <code>rmdup</code> and <code>common</code>.
When comparing with sequences, MD5 digest could be used to replace sequence by
flag <code>-m</code> (<code>--md5</code>).</p>
<p>Some subcommands could either read all records or read the files twice by flag
<code>-2</code> (<code>--two-pass</code>), including <code>sample</code>, <code>split</code>, <code>shuffle</code> and <code>sort</code>.
They use FASTA index for rapid acccess of sequences and reducing memory occupation.</p>
<h3 id="reproducibility">Reproducibility</h3>
<p>Subcommands <code>sample</code> and <code>shuffle</code> use random function, random seed could be
given by flag <code>-s</code> (<code>--rand-seed</code>). This makes sure that sampling result could be
reproduced in different environments with same random seed.</p>
<h2 id="seqkit">seqkit</h2>
<pre><code class="text">SeqKit -- a cross-platform and ultrafast toolkit for FASTA/Q file manipulation

Version: 0.12.0

Author: Wei Shen &lt;shenwei356@gmail.com&gt;

Documents  : http://bioinf.shenwei.me/seqkit
Source code: https://github.com/shenwei356/seqkit
Please cite: https://doi.org/10.1371/journal.pone.0163962

Usage:
  seqkit [command]

Available Commands:
  amplicon        retrieve amplicon (or specific region around it) via primer(s)
  bam             monitoring and online histograms of BAM record features
  common          find common sequences of multiple files by id/name/sequence
  concat          concatenate sequences with same ID from multiple files
  convert         convert FASTQ quality encoding between Sanger, Solexa and Illumina
  duplicate       duplicate sequences N times
  faidx           create FASTA index file and extract subsequence
  fish            look for short sequences in larger sequences using local alignment
  fq2fa           convert FASTQ to FASTA
  fx2tab          convert FASTA/Q to tabular format (with length/GC content/GC skew)
  genautocomplete generate shell autocompletion script
  grep            search sequences by ID/name/sequence/sequence motifs, mismatch allowed
  head            print first N FASTA/Q records
  help            Help about any command
  locate          locate subsequences/motifs, mismatch allowed
  mutate          edit sequence (point mutation, insertion, deletion)
  range           print FASTA/Q records in a range (start:end)
  rename          rename duplicated IDs
  replace         replace name/sequence by regular expression
  restart         reset start position for circular genome
  rmdup           remove duplicated sequences by id/name/sequence
  sample          sample sequences by number or proportion
  sana            sanitize broken single line fastq files
  seq             transform sequences (revserse, complement, extract ID...)
  shuffle         shuffle sequences
  sliding         sliding sequences, circular genome supported
  sort            sort sequences by id/name/sequence/length
  split           split sequences into files by id/seq region/size/parts (mainly for FASTA)
  split2          split sequences into files by size/parts (FASTA, PE/SE FASTQ)
  stats           simple statistics of FASTA/Q files
  subseq          get subsequences by region/gtf/bed, including flanking sequences
  tab2fx          convert tabular format to FASTA/Q format
  translate       translate DNA/RNA to protein sequence (supporting ambiguous bases)
  version         print version information and check for update
  watch           monitoring and online histograms of sequence features

Flags:
      --alphabet-guess-seq-length int   length of sequence prefix of the first FASTA record based on which seqkit guesses the sequence type (0 for whole seq) (default 10000)
  -h, --help                            help for seqkit
      --id-ncbi                         FASTA head is NCBI-style, e.g. &gt;gi|110645304|ref|NC_002516.2| Pseud...
      --id-regexp string                regular expression for parsing ID (default &quot;^(\\S+)\\s?&quot;)
      --infile-list string              file of input files list (one file per line), if given, they are appended to files from cli arguments
  -w, --line-width int                  line width when outputing FASTA format (0 for no wrap) (default 60)
  -o, --out-file string                 out file (&quot;-&quot; for stdout, suffix .gz for gzipped out) (default &quot;-&quot;)
      --quiet                           be quiet and do not show extra information
  -t, --seq-type string                 sequence type (dna|rna|protein|unlimit|auto) (for auto, it automatically detect by the first sequence) (default &quot;auto&quot;)
  -j, --threads int                     number of CPUs. (default value: 1 for single-CPU PC, 2 for others) (default 2)

</code></pre>

<h3 id="datasets">Datasets</h3>
<p>Datasets from <a href="ftp://mirbase.org/pub/mirbase/21/">The miRBase Sequence Database -- Release 21</a></p>
<ul>
<li><a href="ftp://mirbase.org/pub/mirbase/21/hairpin.fa.gz"><code>hairpin.fa.gz</code></a></li>
<li><a href="ftp://mirbase.org/pub/mirbase/21/mature.fa.gz"><code>mature.fa.gz</code></a></li>
<li><a href="ftp://mirbase.org/pub/mirbase/21/miRNA.diff.gz"><code>miRNA.diff.gz</code></a></li>
</ul>
<p>Human genome from <a href="http://uswest.ensembl.org/info/data/ftp/index.html">ensembl</a>
(For <code>seqkit subseq</code>)</p>
<ul>
<li><a href="ftp://ftp.ensembl.org/pub/release-84/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz"><code>Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz</code></a></li>
<li><a href="ftp://ftp.ensembl.org/pub/release-84/gtf/homo_sapiens/Homo_sapiens.GRCh38.84.gtf.gz"><code>Homo_sapiens.GRCh38.84.gtf.gz</code></a></li>
<li><code>Homo_sapiens.GRCh38.84.bed.gz</code> is converted from <code>Homo_sapiens.GRCh38.84.gtf.gz</code>
by <a href="http://bedops.readthedocs.org/en/latest/content/reference/file-management/conversion/gtf2bed.html?highlight=gtf2bed"><code>gtf2bed</code></a>
with command<pre><code>zcat Homo_sapiens.GRCh38.84.gtf.gz \
    | gtf2bed --do-not-sort \
    | gzip -c &gt; Homo_sapiens.GRCh38.84.bed.gz
</code></pre>
</li>
</ul>
<p>Only DNA and gtf/bed data of Chr1 were used:</p>
<ul>
<li>
<p><code>chr1.fa.gz</code></p>
<pre><code>seqkit grep -p 1 Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz -o chr1.fa.gz
</code></pre>
</li>
<li>
<p><code>chr1.gtf.gz</code></p>
<pre><code>zcat Homo_sapiens.GRCh38.84.gtf.gz | grep -w '^1' | gzip -c &gt; chr1.gtf.gz
</code></pre>
</li>
<li>
<p><code>chr1.bed.gz</code></p>
<pre><code>zcat Homo_sapiens.GRCh38.84.bed.gz | grep -w '^1' | gzip -c &gt; chr1.bed.gz
</code></pre>
</li>
</ul>
<h2 id="seq">seq</h2>
<p>Usage</p>
<pre><code class="text">transform sequences (revserse, complement, extract ID...)

Usage:
  seqkit seq [flags]

Flags:
  -p, --complement                complement sequence, flag '-v' is recommended to switch on
      --dna2rna                   DNA to RNA
  -G, --gap-letters string        gap letters (default &quot;- \t.&quot;)
  -h, --help                      help for seq
  -l, --lower-case                print sequences in lower case
  -M, --max-len int               only print sequences shorter than the maximum length (-1 for no limit) (default -1)
  -R, --max-qual float            only print sequences with average quality less than this limit (-1 for no limit) (default -1)
  -m, --min-len int               only print sequences longer than the minimum length (-1 for no limit) (default -1)
  -Q, --min-qual float            only print sequences with average quality qreater or equal than this limit (-1 for no limit) (default -1)
  -n, --name                      only print names
  -i, --only-id                   print ID instead of full head
  -q, --qual                      only print qualities
  -b, --qual-ascii-base int       ASCII BASE, 33 for Phred+33 (default 33)
  -g, --remove-gaps               remove gaps
  -r, --reverse                   reverse sequence
      --rna2dna                   RNA to DNA
  -s, --seq                       only print sequences
  -u, --upper-case                print sequences in upper case
  -v, --validate-seq              validate bases according to the alphabet
  -V, --validate-seq-length int   length of sequence to validate (0 for whole seq) (default 10000)
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Read and print</p>
<ul>
<li>
<p>From file:</p>
<pre><code>$ seqkit seq hairpin.fa.gz
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA

$ seqkit seq read_1.fq.gz
@HWI-D00523:240:HF3WGBCXX:1:1101:2574:2226 1:N:0:CTGTAG
TGAGGAATATTGGTCAATGGGCGCGAGCCTGAACCAGCCAAGTAGCGTGAAGGATGACTGCCCTACGGG
+
HIHIIIIIHIIHGHHIHHIIIIIIIIIIIIIIIHHIIIIIHHIHIIIIIGIHIIIIHHHHHHGHIHIII
</code></pre>
</li>
<li>
<p>From stdin:</p>
<pre><code>zcat hairpin.fa.gz | seqkit seq
</code></pre>
</li>
</ul>
</li>
<li>
<p>Sequence types</p>
<ul>
<li>
<p>By default, <code>seqkit seq</code> automatically detect the sequence type</p>
<pre><code>$ echo -e "&gt;seq\nacgtryswkmbdhvACGTRYSWKMBDHV" | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   DNA          1       28       28       28       28

$ echo -e "&gt;seq\nACGUN ACGUN" | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   RNA          1       11       11       11       11

$ echo -e "&gt;seq\nabcdefghijklmnpqrstvwyz" | seqkit stats
file  format  type     num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   Protein         1       23       23       23       23

$ echo -e "@read\nACTGCN\n+\n@IICCG" | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTQ   DNA          1        6        6        6        6
</code></pre>
</li>
<li>
<p>You can also set sequence type by flag <code>-t</code> (<code>--seq-type</code>).
  But this only take effect on subcommands <code>seq</code> and <code>locate</code>.</p>
<pre><code>$ echo -e "&gt;seq\nabcdefghijklmnpqrstvwyz" | seqkit seq -t dna
[INFO] when flag -t (--seq-type) given, flag -v (--validate-seq) is automatically switched on
[ERRO] error when parsing seq: seq (invalid DNAredundant letter: e)
</code></pre>
</li>
</ul>
</li>
<li>
<p>Only print names</p>
<ul>
<li>
<p>Full name:</p>
<pre><code>$ seqkit seq hairpin.fa.gz -n
cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
cel-lin-4 MI0000002 Caenorhabditis elegans lin-4 stem-loop
cel-mir-1 MI0000003 Caenorhabditis elegans miR-1 stem-loop
</code></pre>
</li>
<li>
<p>Only ID:</p>
<pre><code>$ seqkit seq hairpin.fa.gz -n -i
cel-let-7
cel-lin-4
cel-mir-1
</code></pre>
</li>
<li>
<p>Custom ID region by regular expression (this could be applied to all subcommands):</p>
<pre><code>$ seqkit seq hairpin.fa.gz -n -i --id-regexp "^[^\s]+\s([^\s]+)\s"
MI0000001
MI0000002
MI0000003
</code></pre>
</li>
</ul>
</li>
<li>
<p>Only print seq (global flag <code>-w</code> defines the output line width, <code>0</code> for no wrap)</p>
<pre><code>$ seqkit seq hairpin.fa.gz -s -w 0
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAACUAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
AUGCUUCCGGCCUGUUCCCUGAGACCUCAAGUGUGAGUGUACUAUUGAUGCUUCACACCUGGGCUCUCCGGGUACCAGGACGGUUUGAGCAGAU
AAAGUGACCGUACCGAGCUGCAUACUUCCUUACAUGCCCAUACUAUAUCAUAAAUGGAUAUGGAAUGUAAAGAAGUAUGUAGAACGGGGUGGUAGU
</code></pre>
</li>
<li>
<p>Convert multi-line FASTQ to 4-line FASTQ</p>
<pre><code>$ seqkit seq reads_1.fq.gz -w 0
</code></pre>
</li>
<li>
<p>Reverse comlement sequence</p>
<pre><code>$ seqkit seq hairpin.fa.gz -r -p
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UCGAAGAGUUCUGUCUCCGGUAAGGUAGAAAAUUGCAUAGUUCACCGGUGGUAAUAUUCC
AAACUAUACAACCUACUACCUCACCGGAUCCACAGUGUA
</code></pre>
</li>
<li>
<p>Remove gaps and to lower/upper case</p>
<pre><code>$ echo -e "&gt;seq\nACGT-ACTGC-ACC" | seqkit seq -g -u
&gt;seq
ACGTACTGCACC
</code></pre>
</li>
<li>
<p>RNA to DNA</p>
<pre><code>$ echo -e "&gt;seq\nUCAUAUGCUUGUCUCAAAGAUUA" | seqkit seq --rna2dna
&gt;seq
TCATATGCTTGTCTCAAAGATTA
</code></pre>
</li>
<li>
<p>Filter by sequence length</p>
<pre><code>$ cat hairpin.fa | seqkit seq | seqkit stats
file  format  type  num_seqs    sum_len  min_len  avg_len  max_len
-     FASTA   RNA     28,645  2,949,871       39      103    2,354

$ cat hairpin.fa | seqkit seq -m 100 | seqkit stats
file  format  type  num_seqs    sum_len  min_len  avg_len  max_len
-     FASTA   RNA     10,975  1,565,486      100    142.6    2,354

$ cat hairpin.fa | seqkit seq -m 100 -M 1000 | seqkit stats
file  format  type  num_seqs    sum_len  min_len  avg_len  max_len
-     FASTA   RNA     10,972  1,560,270      100    142.2      938
</code></pre>
</li>
</ol>
<h2 id="subseq">subseq</h2>
<p>Usage</p>
<pre><code class="text">get subsequences by region/gtf/bed, including flanking sequences.

Recommendation: use plain FASTA file, so seqkit could utilize FASTA index.

The definition of region is 1-based and with some custom design.

Examples:

 1-based index    1 2 3 4 5 6 7 8 9 10
negative index    0-9-8-7-6-5-4-3-2-1
           seq    A C G T N a c g t n
           1:1    A
           2:4      C G T
         -4:-2                c g t
         -4:-1                c g t n
         -1:-1                      n
          2:-2      C G T N a c g t
          1:-1    A C G T N a c g t n
          1:12    A C G T N a c g t n
        -12:-1    A C G T N a c g t n

Usage:
  seqkit subseq [flags]

Flags:
      --bed string        by BED file
      --chr value         select limited sequence with sequence IDs when using flag --gtf or --bed  (multiple value supported, case ignored) (default [])
  -d, --down-stream int   down stream length
      --feature value     select limited feature types (multiple value supported, case ignored, only works with GTF) (default [])
      --gtf string        by GTF (version 2.2) file
      --gtf-tag string        output this tag as sequence comment (default &quot;gene_id&quot;)
  -f, --only-flank        only return up/down stream sequence
  -r, --region string     by region. e.g 1:12 for first 12 bases, -12:-1 for last 12 bases, 13:-1 for cutting first 12 bases. type &quot;seqkit subseq -h&quot; for more examples
  -u, --up-stream int     up stream length

</code></pre>

<p>Examples</p>
<p><strong><em>Recommendation: use plain FASTA file, so seqkit could utilize FASTA index.</em></strong></p>
<ol>
<li>
<p>First 12 bases</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit subseq -r 1:12
</code></pre>
</li>
<li>
<p>Last 12 bases</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit subseq -r -12:-1
</code></pre>
</li>
<li>
<p>Subsequences without first and last 12 bases</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit subseq -r 13:-13
</code></pre>
</li>
<li>
<p>Get subsequence by GTF file</p>
<pre><code>$ cat t.fa
&gt;seq
actgACTGactgn

$ cat t.gtf
seq     test    CDS     5       8       .       .       .       gene_id "A"; transcript_id "";
seq     test    CDS     5       8       .       -       .       gene_id "B"; transcript_id "";

$ seqkit subseq --gtf t.gtf t.fa
&gt;seq_5:8:. A
ACTG
&gt;seq_5:8:- B
CAGT
</code></pre>
<p>Human genome example:</p>
<p><strong><em>AVOID loading all data from Homo_sapiens.GRCh38.84.gtf.gz,
the uncompressed data are so big and may exhaust your RAM.</em></strong></p>
<p>We could specify chromesomes and features.</p>
<pre><code>$ seqkit subseq --gtf Homo_sapiens.GRCh38.84.gtf.gz --chr 1 --feature cds  hsa.fa &gt; chr1.gtf.cds.fa

$ seqkit stats chr1.gtf.cds.fa
file             format  type  num_seqs    sum_len  min_len  avg_len  max_len
chr1.gtf.cds.fa  FASTA   DNA     65,012  9,842,274        1    151.4   12,045
</code></pre>
</li>
<li>
<p>Get CDS and 3bp up-stream sequences</p>
<pre><code>$ seqkit subseq --gtf t.gtf t.fa -u 3
&gt;seq_5:8:._us:3 A
ctgACTG
&gt;seq_5:8:-_us:3 B
agtCAGT
</code></pre>
</li>
<li>
<p>Get 3bp up-stream sequences of CDS, not including CDS</p>
<pre><code>$ seqkit subseq --gtf t.gtf t.fa -u 3 -f
&gt;seq_5:8:._usf:3 A
ctg
&gt;seq_5:8:-_usf:3 B
agt
</code></pre>
</li>
<li>
<p>Get subsequences by BED file.</p>
<p><strong><em>AVOID loading all data from Homo_sapiens.GRCh38.84.gtf.gz,
the uncompressed data are so big and may exhaust your RAM.</em></strong></p>
<pre><code>$ seqkit subseq --bed Homo_sapiens.GRCh38.84.bed.gz --chr 1 hsa.fa \
    &gt;  chr1.bed.gz.fa
</code></pre>
<p>We may need to remove duplicated sequences</p>
<pre><code>$ seqkit subseq --bed Homo_sapiens.GRCh38.84.bed.gz --chr 1 hsa.fa \
    | seqkit rmdup &gt; chr1.bed.rmdup.fa
[INFO] 141060 duplicated records removed
</code></pre>
<p>Summary:</p>
<pre><code>$ seqkit stats chr1.gz.*.gz
file               seq_format   seq_type   num_seqs   min_len   avg_len     max_len
chr1.gz.fa         FASTA        DNA         231,974         1   3,089.5   1,551,957
chr1.gz.rmdup.fa   FASTA        DNA          90,914         1   6,455.8   1,551,957
</code></pre>
</li>
</ol>
<h2 id="sliding">sliding</h2>
<p>Usage</p>
<pre><code class="text">sliding sequences, circular genome supported

Usage:
  seqkit sliding [flags]

Flags:
  -C, --circular-genome   circular genome.
  -g, --greedy            greedy mode, i.e., exporting last subsequences even shorter than windows size
  -s, --step int          step size
  -W, --window int        window size

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>General use</p>
<pre><code>$ echo -e "&gt;seq\nACGTacgtNN" | seqkit sliding -s 3 -W 6
&gt;seq_sliding:1-6
ACGTac
&gt;seq_sliding:4-9
TacgtN
</code></pre>
</li>
<li>
<p>Greedy mode</p>
<pre><code>$ echo -e "&gt;seq\nACGTacgtNN" | seqkit sliding -s 3 -W 6 -g
&gt;seq_sliding:1-6
ACGTac
&gt;seq_sliding:4-9
TacgtN
&gt;seq_sliding:7-12
gtNN
&gt;seq_sliding:10-15
N
</code></pre>
</li>
<li>
<p>Circular genome</p>
<pre><code>$ echo -e "&gt;seq\nACGTacgtNN" | seqkit sliding -s 3 -W 6 -C
&gt;seq_sliding:1-6
ACGTac
&gt;seq_sliding:4-9
TacgtN
&gt;seq_sliding:7-2
gtNNAC
&gt;seq_sliding:10-5
NACGTa
</code></pre>
</li>
<li>
<p>Generate GC content for ploting</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit sliding -s 5 -W 30 \
    | seqkit fx2tab -n -g
cel-let-7_sliding:1-30          50.00
cel-let-7_sliding:6-35          46.67
cel-let-7_sliding:11-40         43.33
cel-let-7_sliding:16-45         36.67
cel-let-7_sliding:21-50         33.33
cel-let-7_sliding:26-55         40.00
...
</code></pre>
</li>
</ol>
<h2 id="stats">stats</h2>
<p>Usage</p>
<pre><code class="text">simple statistics of FASTA/Q files

Tips:
  1. For lots of small files (especially on SDD), use big value of '-j' to
     parallelize counting.

Usage:
  seqkit stats [flags]

Aliases:
  stats, stat

Flags:
  -a, --all                  all statistics, including quartiles of seq length, sum_gap, N50
  -b, --basename             only output basename of files
  -E, --fq-encoding string   fastq quality encoding. available values: 'sanger', 'solexa', 'illumina-1.3+', 'illumina-1.5+', 'illumina-1.8+'. (default &quot;sanger&quot;)
  -G, --gap-letters string   gap letters (default &quot;- .&quot;)
  -h, --help                 help for stats
  -e, --skip-err             skip error, only show warning message
  -T, --tabular              output in machine-friendly tabular format
</code></pre>

<p>Eexamples</p>
<ol>
<li>
<p>General use</p>
<pre><code>$ seqkit stats *.f{a,q}.gz
file           format  type  num_seqs    sum_len  min_len  avg_len  max_len
hairpin.fa.gz  FASTA   RNA     28,645  2,949,871       39      103    2,354
mature.fa.gz   FASTA   RNA     35,828    781,222       15     21.8       34
reads_1.fq.gz  FASTQ   DNA      2,500    567,516      226      227      229
reads_2.fq.gz  FASTQ   DNA      2,500    560,002      223      224      225
</code></pre>
</li>
<li>
<p>Machine-friendly tabular format</p>
<pre><code>$ seqkit stats *.f{a,q}.gz -T
file    format  type    num_seqs        sum_len min_len avg_len max_len
hairpin.fa.gz   FASTA   RNA     28645   2949871 39      103.0   2354
mature.fa.gz    FASTA   RNA     35828   781222  15      21.8    34
Illimina1.8.fq.gz       FASTQ   DNA     10000   1500000 150     150.0   150
reads_1.fq.gz   FASTQ   DNA     2500    567516  226     227.0   229
reads_2.fq.gz   FASTQ   DNA     2500    560002  223     224.0   225

# So you can process the result with tools like csvtk: http://bioinf.shenwei.me/csvtk

$ seqkit stats *.f{a,q}.gz -T | csvtk pretty -t
file                format   type   num_seqs   sum_len   min_len   avg_len   max_len
hairpin.fa.gz       FASTA    RNA    28645      2949871   39        103.0     2354
mature.fa.gz        FASTA    RNA    35828      781222    15        21.8      34
Illimina1.8.fq.gz   FASTQ    DNA    10000      1500000   150       150.0     150
reads_1.fq.gz       FASTQ    DNA    2500       567516    226       227.0     229
reads_2.fq.gz       FASTQ    DNA    2500       560002    223       224.0     225

# To markdown

$ seqkit stats *.f{a,q}.gz -T | csvtk csv2md -t
file             |format|type|num_seqs|sum_len|min_len|avg_len|max_len
:----------------|:-----|:---|:-------|:------|:------|:------|:------
hairpin.fa.gz    |FASTA |RNA |28645   |2949871|39     |103.0  |2354
mature.fa.gz     |FASTA |RNA |35828   |781222 |15     |21.8   |34
Illimina1.8.fq.gz|FASTQ |DNA |10000   |1500000|150    |150.0  |150
reads_1.fq.gz    |FASTQ |DNA |2500    |567516 |226    |227.0  |229
reads_2.fq.gz    |FASTQ |DNA |2500    |560002 |223    |224.0  |225
</code></pre>
<table>
<thead>
<tr>
<th align="left">file</th>
<th align="left">format</th>
<th align="left">type</th>
<th align="left">num_seqs</th>
<th align="left">sum_len</th>
<th align="left">min_len</th>
<th align="left">avg_len</th>
<th align="left">max_len</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">hairpin.fa.gz</td>
<td align="left">FASTA</td>
<td align="left">RNA</td>
<td align="left">28645</td>
<td align="left">2949871</td>
<td align="left">39</td>
<td align="left">103.0</td>
<td align="left">2354</td>
</tr>
<tr>
<td align="left">mature.fa.gz</td>
<td align="left">FASTA</td>
<td align="left">RNA</td>
<td align="left">35828</td>
<td align="left">781222</td>
<td align="left">15</td>
<td align="left">21.8</td>
<td align="left">34</td>
</tr>
<tr>
<td align="left">Illimina1.8.fq.gz</td>
<td align="left">FASTQ</td>
<td align="left">DNA</td>
<td align="left">10000</td>
<td align="left">1500000</td>
<td align="left">150</td>
<td align="left">150.0</td>
<td align="left">150</td>
</tr>
<tr>
<td align="left">reads_1.fq.gz</td>
<td align="left">FASTQ</td>
<td align="left">DNA</td>
<td align="left">2500</td>
<td align="left">567516</td>
<td align="left">226</td>
<td align="left">227.0</td>
<td align="left">229</td>
</tr>
<tr>
<td align="left">reads_2.fq.gz</td>
<td align="left">FASTQ</td>
<td align="left">DNA</td>
<td align="left">2500</td>
<td align="left">560002</td>
<td align="left">223</td>
<td align="left">224.0</td>
<td align="left">225</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Extra information</p>
<pre><code>$ seqkit stats *.f{a,q}.gz -a
file               format  type  num_seqs    sum_len  min_len  avg_len  max_len   Q1   Q2   Q3  sum_gap  N50  Q20(%)  Q30(%)
hairpin.fa.gz      FASTA   RNA     28,645  2,949,871       39      103    2,354   76   91  111        0  101       0       0
mature.fa.gz       FASTA   RNA     35,828    781,222       15     21.8       34   21   22   22        0   22       0       0
Illimina1.8.fq.gz  FASTQ   DNA     10,000  1,500,000      150      150      150  150  150  150        0  150   96.16   89.71
reads_1.fq.gz      FASTQ   DNA      2,500    567,516      226      227      229  227  227  227        0  227   91.24   86.62
reads_2.fq.gz      FASTQ   DNA      2,500    560,002      223      224      225  224  224  224        0  224   91.06   87.66
</code></pre>
</li>
<li>
<p>Parallelize counting files, it's much faster for lots of small files, especially for files on SSD</p>
<pre><code>seqkit stats -j 10 refseq/virual/*.fna.gz
</code></pre>
</li>
<li>
<p>Skip error</p>
<pre><code>$ seqkit stats tests/*
[ERRO] tests/hairpin.fa.fai: fastx: invalid FASTA/Q format

$ seqkit stats tests/* -e
[WARN] tests/hairpin.fa.fai: fastx: invalid FASTA/Q format
[WARN] tests/hairpin.fa.seqkit.fai: fastx: invalid FASTA/Q format
[WARN] tests/miRNA.diff.gz: fastx: invalid FASTA/Q format
[WARN] tests/test.sh: fastx: invalid FASTA/Q format
file                     format  type  num_seqs    sum_len  min_len  avg_len  max_len
tests/contigs.fa         FASTA   DNA          9         54        2        6       10
tests/hairpin.fa         FASTA   RNA     28,645  2,949,871       39      103    2,354
tests/Illimina1.5.fq     FASTQ   DNA          1        100      100      100      100
tests/Illimina1.8.fq.gz  FASTQ   DNA     10,000  1,500,000      150      150      150
tests/hairpin.fa.gz      FASTA   RNA     28,645  2,949,871       39      103    2,354
tests/reads_1.fq.gz      FASTQ   DNA      2,500    567,516      226      227      229
tests/mature.fa.gz       FASTA   RNA     35,828    781,222       15     21.8       34
tests/reads_2.fq.gz      FASTQ   DNA      2,500    560,002      223      224      225
</code></pre>
</li>
<li>
<p>Output basename instead of full path (<code>-b/--basename</code>)</p>
</li>
</ol>
<h2 id="faidx">faidx</h2>
<p>Usage</p>
<pre><code class="text">create FASTA index file and extract subsequence

This command is similar with &quot;samtools faidx&quot; but has some extra features:

  1. output full header line with flag -f
  2. support regular expression as sequence ID with flag -r
  3. if you have large number of IDs, you can use:
        seqkit faidx seqs.fasta --infile-list IDs.txt

Usage:
  seqkit faidx [flags] &lt;fasta-file&gt; [regions...]

Flags:
  -f, --full-head     print full header line instead of just ID. New fasta index file ending with .seqkit.fai will be created
  -h, --help          help for faidx
  -i, --ignore-case   ignore case
  -r, --use-regexp    IDs are regular expression. But subseq region is not suppored here.

</code></pre>

<p>Example</p>
<ol>
<li>
<p>common usage like <code>samtools faidx</code></p>
<pre><code>$ seqkit faidx tests/hairpin.fa hsa-let-7a-1 hsa-let-7a-2
&gt;hsa-let-7a-1
UGGGAUGAGGUAGUAGGUUGUAUAGUUUUAGGGUCACACCCACCACUGGGAGAUAACUAU
ACAAUCUACUGUCUUUCCUA
&gt;hsa-let-7a-2
AGGUUGAGGUAGUAGGUUGUAUAGUUUAGAAUUACAUCAAGGGAGAUAACUGUACAGCCU
CCUAGCUUUCCU
</code></pre>
</li>
<li>
<p>output full header, not supported by <code>samtools faidx</code></p>
<pre><code>$ seqkit faidx tests/hairpin.fa hsa-let-7a-1 hsa-let-7a-2 -f
&gt;hsa-let-7a-1 MI0000060 Homo sapiens let-7a-1 stem-loop
UGGGAUGAGGUAGUAGGUUGUAUAGUUUUAGGGUCACACCCACCACUGGGAGAUAACUAU
ACAAUCUACUGUCUUUCCUA
&gt;hsa-let-7a-2 MI0000061 Homo sapiens let-7a-2 stem-loop
AGGUUGAGGUAGUAGGUUGUAUAGUUUAGAAUUACAUCAAGGGAGAUAACUGUACAGCCU
CCUAGCUUUCCU
</code></pre>
</li>
<li>
<p>extract subsequence of specific region</p>
<pre><code>$ seqkit faidx tests/hairpin.fa hsa-let-7a-1:1-10
&gt;hsa-let-7a-1:1-10
UGGGAUGAGG

$ seqkit faidx tests/hairpin.fa hsa-let-7a-1:-10--1
&gt;hsa-let-7a-1:-10--1
GUCUUUCCUA

$ seqkit faidx tests/hairpin.fa hsa-let-7a-1:1
&gt;hsa-let-7a-1:1-1
U
</code></pre>
</li>
<li>
<p>use regular expression</p>
<pre><code>$ seqkit faidx tests/hairpin.fa hsa -r | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   RNA      1,881  154,002       41     81.9      180
</code></pre>
</li>
</ol>
<h2 id="watch">watch</h2>
<p>Usage</p>
<pre><code class="text">monitoring and online histograms of sequence features

Usage:
  seqkit watch [flags]

Flags:
  -B, --bins int                  number of histogram bins (default -1)
  -W, --delay int                 sleep this many seconds after online plotting (default 1)
  -y, --dump                      print histogram data to stderr instead of plotting
  -f, --fields string             target fields (default &quot;ReadLen&quot;)
  -h, --help                      help for watch
  -O, --img string                save histogram to this PDF/image file
  -H, --list-fields               print out a list of available fields
  -L, --log                       log10(x+1) transform numeric values
  -x, --pass                      pass through mode (write input to stdout)
  -p, --print-freq int            print/report after this many records (-1 for print after EOF) (default -1)
  -b, --qual-ascii-base int       ASCII BASE, 33 for Phred+33 (default 33)
  -Q, --quiet-mode                supress all plotting to stderr
  -R, --reset                     reset histogram after every report
  -v, --validate-seq              validate bases according to the alphabet
  -V, --validate-seq-length int   length of sequence to validate (0 for whole seq) (default 10000)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Histogram of log sequence length</p>
<pre><code>seqkit watch -L -f ReadLen hairpin.fa
</code></pre>
</li>
<li>
<p>Histogram of mean base qualities every 500 record, also saved as PDF</p>
<pre><code>seqkit watch -p 500 -O qhist.pdf -f MeanQual reads_1.fq.gz
</code></pre>
</li>
</ol>
<h2 id="sana">sana</h2>
<p>Usage</p>
<pre><code class="text">sanitize broken single line fastq files

Usage:
  seqkit sana [flags]

Flags:
  -h, --help                  help for sana
  -b, --qual-ascii-base int   ASCII BASE, 33 for Phred+33 (default 33)

</code></pre>

<p>Examples</p>
<ol>
<li>Rescue usable reads from fastq file with malformed records.<pre><code>seqkit sana broken.fq.gz -o rescued.fq.gz
</code></pre>
</li>
</ol>
<h2 id="fq2fa">fq2fa</h2>
<p>Usage</p>
<pre><code class="text">convert FASTQ to FASTA

Usage:
  seqkit fq2fa [flags]

</code></pre>

<p>Examples</p>
<pre><code>seqkit fq2fa reads_1.fq.gz -o reads_1.fa.gz
</code></pre>
<h2 id="fx2tab-tab2fx">fx2tab &amp; tab2fx</h2>
<p>Usage (fx2tab)</p>
<pre><code class="text">convert FASTA/Q to tabular format, and provide various information,
like sequence length, GC content/GC skew.

Usage:
  seqkit fx2tab [flags]

Flags:
  -B, --base-content value   print base content. (case ignored, multiple values supported) e.g. -B AT -B N (default [])
  -g, --gc                   print GC content
  -G, --gc-skew              print GC-Skew
  -H, --header-line          print header line
  -l, --length               print sequence length
  -n, --name                 only print names (no sequences and qualities)
  -i, --only-id              print ID instead of full head

</code></pre>

<p>Usage (tab2fx)</p>
<pre><code class="text">convert tabular format (first two/three columns) to FASTA/Q format

Usage:
  seqkit tab2fx [flags]

Flags:
  -p, --comment-line-prefix value   comment line prefix (default [#,//])

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Default output</p>
<pre><code>$ seqkit fx2tab hairpin.fa.gz | head -n 2
cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop      UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAACUAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
cel-lin-4 MI0000002 Caenorhabditis elegans lin-4 stem-loop      AUGCUUCCGGCCUGUUCCCUGAGACCUCAAGUGUGAGUGUACUAUUGAUGCUUCACACCUGGGCUCUCCGGGUACCAGGACGGUUUGAGCAGAU
</code></pre>
</li>
<li>
<p>Print sequence length, GC content, and only print names (no sequences),
we could also print title line by flag <code>-H</code>.</p>
<pre><code>$ seqkit fx2tab hairpin.fa.gz -l -g -n -i -H | head -n 4 | csvtk -t -C '&amp;' pretty
#name       seq   qual   length   GC
cel-let-7                99       43.43
cel-lin-4                94       54.26
cel-mir-1                96       40.62
</code></pre>
</li>
<li>
<p>Use fx2tab and tab2fx in pipe</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit fx2tab | seqkit tab2fx

$ zcat reads_1.fq.gz | seqkit fx2tab | seqkit tab2fx
</code></pre>
</li>
<li>
<p>Sort sequences by length (use <code>seqkit sort -l</code>)</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit fx2tab -l \
    | sort -t"`echo -e '\t'`" -n -k4,4 \
    | seqkit tab2fx
&gt;cin-mir-4129 MI0015684 Ciona intestinalis miR-4129 stem-loop
UUCGUUAUUGGAAGACCUUAGUCCGUUAAUAAAGGCAUC
&gt;mmu-mir-7228 MI0023723 Mus musculus miR-7228 stem-loop
UGGCGACCUGAACAGAUGUCGCAGUGUUCGGUCUCCAGU
&gt;cin-mir-4103 MI0015657 Ciona intestinalis miR-4103 stem-loop
ACCACGGGUCUGUGACGUAGCAGCGCUGCGGGUCCGCUGU

$ seqkit sort -l hairpin.fa.gz
</code></pre>
<p>Sorting or filtering by GC (or other base by -flag <code>-B</code>) content could also achieved in similar way.</p>
</li>
<li>
<p>Get first 1000 sequences (use <code>seqkit head -n 1000</code>)</p>
<pre><code>$ seqkit fx2tab hairpin.fa.gz | head -n 1000 | seqkit tab2fx

$ seqkit fx2tab reads_1.fq.gz | head -n 1000 | seqkit tab2fx
</code></pre>
</li>
</ol>
<p><strong>Extension</strong></p>
<p>After converting FASTA to tabular format with <code>seqkit fx2tab</code>,
it could be handled with CSV/TSV tools,
 e.g. <a href="https://github.com/shenwei356/csvtkt">csvtk</a>, a cross-platform, efficient and practical CSV/TSV toolkit</p>
<ul>
<li><code>csvtk grep</code> could be used to filter sequences (similar with <code>seqkit grep</code>)</li>
<li><code>csvtk inter</code>
computates intersection of multiple files. It could achieve similar function
as <code>seqkit common -n</code> along with shell.</li>
<li><code>csvtk join</code> joins multiple CSV/TSV files by multiple IDs.</li>
<li><a href="https://github.com/shenwei356/datakit/blob/master/csv_melt">csv_melt</a>
provides melt function, could be used in preparation of data for ploting.</li>
</ul>
<h2 id="convert">convert</h2>
<p>Usage</p>
<pre><code class="text">convert FASTQ quality encoding between Sanger, Solexa and Illumina

Usage:
  seqkit convert [flags]

Flags:
  -d, --dry-run                         dry run
  -f, --force                           for Illumina-1.8+ -&gt; Sanger, truncate scores &gt; 40 to 40
      --from string                     source quality encoding. if not given, we'll guess it
  -h, --help                            help for convert
  -n, --nrecords int                    number of records for guessing quality encoding (default 1000)
  -N, --thresh-B-in-n-most-common int   threshold of 'B' in top N most common quality for guessing Illumina 1.5. (default 4)
  -F, --thresh-illumina1.5-frac float   threshold of faction of Illumina 1.5 in the leading N records (default 0.1)
      --to string                       target quality encoding (default &quot;Sanger&quot;)
</code></pre>

<p>Examples:</p>
<p>Note that <code>seqkit convert</code> always output sequences.</p>
<p>The test dataset contains score 41 (<code>J</code>):</p>
<pre><code>$ seqkit head -n 1 tests/Illimina1.8.fq.gz
@ST-E00493:56:H33MFALXX:4:1101:23439:1379 1:N:0:NACAACCA
NCGTGGAAAGACGCTAAGATTGTGATGTGCTTCCCTGACGATTACAACTGGCGTAAGGACGTTTTGCCTACCTATAAGGCTAACCGTAAGGGTTCTCGCAAGCCTGTAGGTTACAAGAGGTTCGTAGCCGAAGTGATGGCTGACTCACGG
+
#AAAFAAJFFFJJJ&lt;JJJJJFFFJFJJJJJFJJAJJJFJJFJFJJJJFAFJ&lt;JA&lt;FFJ7FJJFJJAAJJJJ&lt;JJJJJJJFJJJAJJJJJFJJ77&lt;JJJJ-F7A-FJFFJJJJJJ&lt;FFJ-&lt;7FJJJFJJ)A7)7AA&lt;7--)&lt;-7F-A7FA&lt;
</code></pre>

<p>By default, nothing changes when converting Illumina 1.8 to Sanger. A warning message show that source and target quality encoding match.</p>
<pre><code>$ seqkit convert tests/Illimina1.8.fq.gz  | seqkit head -n 1
[INFO] possible quality encodings: [Illumina-1.8+]
[INFO] guessed quality encoding: Illumina-1.8+
[INFO] converting Illumina-1.8+ -&gt; Sanger
[WARN] source and target quality encoding match.
@ST-E00493:56:H33MFALXX:4:1101:23439:1379 1:N:0:NACAACCA
NCGTGGAAAGACGCTAAGATTGTGATGTGCTTCCCTGACGATTACAACTGGCGTAAGGACGTTTTGCCTACCTATAAGGCTAACCGTAAGGGTTCTCGCAAGCCTGTAGGTTACAAGAGGTTCGTAGCCGAAGTGATGGCTGACTCACGG
+
#AAAFAAJFFFJJJ&lt;JJJJJFFFJFJJJJJFJJAJJJFJJFJFJJJJFAFJ&lt;JA&lt;FFJ7FJJFJJAAJJJJ&lt;JJJJJJJFJJJAJJJJJFJJ77&lt;JJJJ-F7A-FJFFJJJJJJ&lt;FFJ-&lt;7FJJJFJJ)A7)7AA&lt;7--)&lt;-7F-A7FA&lt;
</code></pre>

<p>When switching flag <code>--force</code> on,  <code>J</code> (41) was converted to <code>I</code> (40).</p>
<pre><code>$ seqkit convert tests/Illimina1.8.fq.gz -f | seqkit head -n 1
[INFO] possible quality encodings: [Illumina-1.8+]
[INFO] guessed quality encoding: Illumina-1.8+
[INFO] converting Illumina-1.8+ -&gt; Sanger
@ST-E00493:56:H33MFALXX:4:1101:23439:1379 1:N:0:NACAACCA
NCGTGGAAAGACGCTAAGATTGTGATGTGCTTCCCTGACGATTACAACTGGCGTAAGGACGTTTTGCCTACCTATAAGGCTAACCGTAAGGGTTCTCGCAAGCCTGTAGGTTACAAGAGGTTCGTAGCCGAAGTGATGGCTGACTCACGG
+
#AAAFAAIFFFIII&lt;IIIIIFFFIFIIIIIFIIAIIIFIIFIFIIIIFAFI&lt;IA&lt;FFI7FIIFIIAAIIII&lt;IIIIIIIFIIIAIIIIIFII77&lt;IIII-F7A-FIFFIIIIII&lt;FFI-&lt;7FIIIFII)A7)7AA&lt;7--)&lt;-7F-A7FA&lt;
</code></pre>

<p>Other cases:</p>
<p>To Illumina-1.5.</p>
<pre><code>$ seqkit convert tests/Illimina1.8.fq.gz --to Illumina-1.5+ | seqkit head -n 1
[INFO] possible quality encodings: [Illumina-1.8+]
[INFO] guessed quality encoding: Illumina-1.8+
[INFO] converting Illumina-1.8+ -&gt; Illumina-1.5+
@ST-E00493:56:H33MFALXX:4:1101:23439:1379 1:N:0:NACAACCA
NCGTGGAAAGACGCTAAGATTGTGATGTGCTTCCCTGACGATTACAACTGGCGTAAGGACGTTTTGCCTACCTATAAGGCTAACCGTAAGGGTTCTCGCAAGCCTGTAGGTTACAAGAGGTTCGTAGCCGAAGTGATGGCTGACTCACGG
+
B```e``ieeeiii[iiiiieeeieiiiiieii`iiieiieieiiiie`ei[i`[eeiVeiieii``iiii[iiiiiiieiii`iiiiieiiVV[iiiiLeV`Leieeiiiiii[eeiL[VeiiieiiH`VHV``[VLLH[LVeL`Ve`[
</code></pre>

<p>To Illumina-1.5 and back to Sanger.</p>
<pre><code>$ seqkit convert tests/Illimina1.8.fq.gz --to Illumina-1.5+ | seqkit convert | seqkit head -n 1
[INFO] possible quality encodings: [Illumina-1.8+]
[INFO] guessed quality encoding: Illumina-1.8+
[INFO] converting Illumina-1.8+ -&gt; Illumina-1.5+
[INFO] possible quality encodings: [Illumina-1.5+]
[INFO] guessed quality encoding: Illumina-1.5+
[INFO] converting Illumina-1.5+ -&gt; Sanger
@ST-E00493:56:H33MFALXX:4:1101:23439:1379 1:N:0:NACAACCA
NCGTGGAAAGACGCTAAGATTGTGATGTGCTTCCCTGACGATTACAACTGGCGTAAGGACGTTTTGCCTACCTATAAGGCTAACCGTAAGGGTTCTCGCAAGCCTGTAGGTTACAAGAGGTTCGTAGCCGAAGTGATGGCTGACTCACGG
+
!AAAFAAJFFFJJJ&lt;JJJJJFFFJFJJJJJFJJAJJJFJJFJFJJJJFAFJ&lt;JA&lt;FFJ7FJJFJJAAJJJJ&lt;JJJJJJJFJJJAJJJJJFJJ77&lt;JJJJ-F7A-FJFFJJJJJJ&lt;FFJ-&lt;7FJJJFJJ)A7)7AA&lt;7--)&lt;-7F-A7FA&lt;
</code></pre>

<p>Checking encoding</p>
<pre><code>$ seqkit convert tests/Illimina1.8.fq.gz --from Solexa
[INFO] converting Solexa -&gt; Sanger
[ERRO] seq: invalid Solexa quality
</code></pre>

<p>Real Illumina 1.5+ data</p>
<pre><code>$ seqkit seq tests/Illimina1.5.fq
@HWI-EAS209_0006_FC706VJ:5:58:5894:21141#ATCACG/1
TTAATTGGTAAATAAATCTCCTAATAGCTTAGATNTTACCTTNNNNNNNNNNTAGTTTCTTGAGATTTGTTGGGGGAGACATTTTTGTGATTGCCTTGAT
+
efcfffffcfeefffcffffffddf`feed]`]_Ba_^__[YBBBBBBBBBBRTT\]][]dddd`ddd^dddadd^BBBBBBBBBBBBBBBBBBBBBBBB

$ seqkit convert tests/Illimina1.5.fq | seqkit head -n 1
[INFO] possible quality encodings: [Illumina-1.5+]
[INFO] guessed quality encoding: Illumina-1.5+
[INFO] converting Illumina-1.5+ -&gt; Sanger
@HWI-EAS209_0006_FC706VJ:5:58:5894:21141#ATCACG/1
TTAATTGGTAAATAAATCTCCTAATAGCTTAGATNTTACCTTNNNNNNNNNNTAGTTTCTTGAGATTTGTTGGGGGAGACATTTTTGTGATTGCCTTGAT
+
FGDGGGGGDGFFGGGDGGGGGGEEGAGFFE&gt;A&gt;@!B@?@@&lt;:!!!!!!!!!!355=&gt;&gt;&lt;&gt;EEEEAEEE?EEEBEE?!!!!!!!!!!!!!!!!!!!!!!!!
</code></pre>

<h2 id="translate">translate</h2>
<p>Usage</p>
<pre><code class="text">translate DNA/RNA to protein sequence (supporting ambiguous bases)

Note:

  1. this command supports codons containing any ambiguous base.
     Plese switch on flag -L for details. e.g., for standard table:

        ACN -&gt; T
        CCN -&gt; P
        CGN -&gt; R
        CTN -&gt; L
        GCN -&gt; A
        GGN -&gt; G
        GTN -&gt; V
        TCN -&gt; S

        MGR -&gt; R
        YTR -&gt; L

Translate Tables/Genetic Codes:

    # https://www.ncbi.nlm.nih.gov/Taxonomy/taxonomyhome.html/index.cgi?chapter=tgencodes

     1: The Standard Code
     2: The Vertebrate Mitochondrial Code
     3: The Yeast Mitochondrial Code
     4: The Mold, Protozoan, and Coelenterate Mitochondrial Code and the Mycoplasma/Spiroplasma Code
     5: The Invertebrate Mitochondrial Code
     6: The Ciliate, Dasycladacean and Hexamita Nuclear Code
     9: The Echinoderm and Flatworm Mitochondrial Code
    10: The Euplotid Nuclear Code
    11: The Bacterial, Archaeal and Plant Plastid Code
    12: The Alternative Yeast Nuclear Code
    13: The Ascidian Mitochondrial Code
    14: The Alternative Flatworm Mitochondrial Code
    16: Chlorophycean Mitochondrial Code
    21: Trematode Mitochondrial Code
    22: Scenedesmus obliquus Mitochondrial Code
    23: Thraustochytrium Mitochondrial Code
    24: Pterobranchia Mitochondrial Code
    25: Candidate Division SR1 and Gracilibacteria Code
    26: Pachysolen tannophilus Nuclear Code
    27: Karyorelict Nuclear
    28: Condylostoma Nuclear
    29: Mesodinium Nuclear
    30: Peritrich Nuclear
    31: Blastocrithidia Nuclear

Usage:
  seqkit translate [flags]

Flags:
  -x, --allow-unknown-codon                     translate unknown code to 'X'. And you may not use flag --trim which removes 'X'
      --clean                                   change all STOP codon positions from the '*' character to 'X' (an unknown residue)
  -f, --frame strings                           frame(s) to translate, available value: 1, 2, 3, -1, -2, -3, and 6 for all six frames (default [1])
  -h, --help                                    help for translate
  -M, --init-codon-as-M                         translate initial codon at beginning to 'M'
  -l, --list-transl-table int                   show details of translate table N, 0 for all (default -1)
  -L, --list-transl-table-with-amb-codons int   show details of translate table N (including ambigugous codons), 0 for all.  (default -1)
  -T, --transl-table int                        translate table/genetic code, type 'seqkit translate --help' for more details (default 1)
      --trim                                    remove all 'X' and '*' characters from the right end of the translation

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>common usage</p>
<pre><code>$ seqkit translate tests/mouse-p53-cds.fna
&gt;lcl|AB021961.1_cds_BAA82344.1_1 [gene=p53] [protein=P53] [protein_id=BAA82344.1] [location=101..1273] [gbkey=CDS]
MTAMEESQSDISLELPLSQETFSGLWKLLPPEDILPSPHCMDDLLLPQDVEEFFEGPSEA
LRVSGAPAAQDPVTETPGPVAPAPATPWPLSSFVPSQKTYQGNYGFHLGFLQSGTAKSVM
CTYSPPLNKLFCQLAKTCPVQLWVSATPPAGSRVRAMAIYKKSQHMTEVVRRCPHHERCS
DGDGLAPPQHRIRVEGNLYPEYLEDRQTFRHSVVVPYEPPEAGSEYTTIHYKYMCNSSCM
GGMNRRPILTIITLEDSSGNLLGRDSFEVRVCACPGRDRRTEEENFRKKEVLCPELPPGS
AKRALPTCTSASPPQKKKPLDGEYFTLKIRGRKRFEMFRELNEALELKDAHATEESGDSR
AHSSYLKTKKGQSTSRHKKTMVKKVGPDSD*
</code></pre>
</li>
<li>
<p>trim the <code>*</code></p>
<pre><code>$ seqkit translate tests/mouse-p53-cds.fna --trim
&gt;lcl|AB021961.1_cds_BAA82344.1_1 [gene=p53] [protein=P53] [protein_id=BAA82344.1] [location=101..1273] [gbkey=CDS]
MTAMEESQSDISLELPLSQETFSGLWKLLPPEDILPSPHCMDDLLLPQDVEEFFEGPSEA
LRVSGAPAAQDPVTETPGPVAPAPATPWPLSSFVPSQKTYQGNYGFHLGFLQSGTAKSVM
CTYSPPLNKLFCQLAKTCPVQLWVSATPPAGSRVRAMAIYKKSQHMTEVVRRCPHHERCS
DGDGLAPPQHRIRVEGNLYPEYLEDRQTFRHSVVVPYEPPEAGSEYTTIHYKYMCNSSCM
GGMNRRPILTIITLEDSSGNLLGRDSFEVRVCACPGRDRRTEEENFRKKEVLCPELPPGS
AKRALPTCTSASPPQKKKPLDGEYFTLKIRGRKRFEMFRELNEALELKDAHATEESGDSR
AHSSYLKTKKGQSTSRHKKTMVKKVGPDSD
</code></pre>
</li>
<li>
<p>different translate table</p>
<pre><code>$ cat tests/Lactococcus-lactis-phage-BK5-T-ORF25.fasta \
    | seqkit translate -T 11 --trim
&gt;CAC80166.1 hypothetical protein [Lactococcus phage BK5-T]
MEEQAWREVLERLARIETKLDNYETVRDKAERALLIAQSNAKLIEKMEANNKWAWGFMLT
LAVTVIGYLFTKIRF
</code></pre>
</li>
<li>
<p>different frame</p>
<pre><code>$ cat tests/Lactococcus-lactis-phage-BK5-T-ORF25.fasta \
    | seqkit translate -T 11 --frame -1
&gt;CAC80166.1 hypothetical protein [Lactococcus phage BK5-T]
SESNFSE*ITNNSYGKSKHKAPSPLIISFHFFYKFRI*LSY*ERSFCFISNCFIVI*LCF
NSS*TFEDFSPCLFLH

$ cat tests/Lactococcus-lactis-phage-BK5-T-ORF25.fasta \
    | seqkit seq -r -p \
    | seqkit translate -T 11 --frame -1
&gt;CAC80166.1 hypothetical protein [Lactococcus phage BK5-T]
MEEQAWREVLERLARIETKLDNYETVRDKAERALLIAQSNAKLIEKMEANNKWAWGFMLT
LAVTVIGYLFTKIRF*
</code></pre>
</li>
<li>
<p>show details of translate table 1</p>
<pre><code>$ seqkit translate -l 1
The Standard Code (transl_table=1)
Source: https://www.ncbi.nlm.nih.gov/Taxonomy/taxonomyhome.html/index.cgi?chapter=tgencodes#SG1

Initiation Codons:
    ATG, CTG, TTG

Stop Codons:
    TAA, TAG, TGA

Stranslate Table:
    AAA: K, AAC: N, AAG: K, AAT: N
    ACA: T, ACC: T, ACG: T, ACT: T
    AGA: R, AGC: S, AGG: R, AGT: S
    ATA: I, ATC: I, ATG: M, ATT: I

    CAA: Q, CAC: H, CAG: Q, CAT: H
    CCA: P, CCC: P, CCG: P, CCT: P
    CGA: R, CGC: R, CGG: R, CGT: R
    CTA: L, CTC: L, CTG: L, CTT: L

    GAA: E, GAC: D, GAG: E, GAT: D
    GCA: A, GCC: A, GCG: A, GCT: A
    GGA: G, GGC: G, GGG: G, GGT: G
    GTA: V, GTC: V, GTG: V, GTT: V

    TAA: *, TAC: Y, TAG: *, TAT: Y
    TCA: S, TCC: S, TCG: S, TCT: S
    TGA: *, TGC: C, TGG: W, TGT: C
    TTA: L, TTC: F, TTG: L, TTT: F
</code></pre>
</li>
<li>
<p>show details of translate table 1, including ambigugous codons</p>
<pre><code>$ seqkit translate -L 1
The Standard Code (transl_table=1)
Source: https://www.ncbi.nlm.nih.gov/Taxonomy/taxonomyhome.html/index.cgi?chapter=tgencodes#SG1

Initiation Codons:
    ATG, CTG, TTG

Stop Codons:
    TAA, TAG, TGA

Stranslate Table:
    AAA: K, AAC: N, AAG: K, AAR: K, AAT: N, AAY: N
    ACA: T, ACC: T, ACM: T, ACG: T, ACR: T, ACS: T, ACV: T, ACT: T, ACW: T, ACY: T, ACH: T, ACK: T, ACD: T, ACB: T, ACN: T
    AGA: R, AGC: S, AGG: R, AGR: R, AGT: S, AGY: S
    ATA: I, ATC: I, ATM: I, ATG: M, ATT: I, ATW: I, ATY: I, ATH: I

    CAA: Q, CAC: H, CAG: Q, CAR: Q, CAT: H, CAY: H
    CCA: P, CCC: P, CCM: P, CCG: P, CCR: P, CCS: P, CCV: P, CCT: P, CCW: P, CCY: P, CCH: P, CCK: P, CCD: P, CCB: P, CCN: P
    CGA: R, CGC: R, CGM: R, CGG: R, CGR: R, CGS: R, CGV: R, CGT: R, CGW: R, CGY: R, CGH: R, CGK: R, CGD: R, CGB: R, CGN: R
    CTA: L, CTC: L, CTM: L, CTG: L, CTR: L, CTS: L, CTV: L, CTT: L, CTW: L, CTY: L, CTH: L, CTK: L, CTD: L, CTB: L, CTN: L

    MGA: R, MGG: R, MGR: R

    GAA: E, GAC: D, GAG: E, GAR: E, GAT: D, GAY: D
    GCA: A, GCC: A, GCM: A, GCG: A, GCR: A, GCS: A, GCV: A, GCT: A, GCW: A, GCY: A, GCH: A, GCK: A, GCD: A, GCB: A, GCN: A
    GGA: G, GGC: G, GGM: G, GGG: G, GGR: G, GGS: G, GGV: G, GGT: G, GGW: G, GGY: G, GGH: G, GGK: G, GGD: G, GGB: G, GGN: G
    GTA: V, GTC: V, GTM: V, GTG: V, GTR: V, GTS: V, GTV: V, GTT: V, GTW: V, GTY: V, GTH: V, GTK: V, GTD: V, GTB: V, GTN: V

    TAA: *, TAC: Y, TAG: *, TAR: *, TAT: Y, TAY: Y
    TCA: S, TCC: S, TCM: S, TCG: S, TCR: S, TCS: S, TCV: S, TCT: S, TCW: S, TCY: S, TCH: S, TCK: S, TCD: S, TCB: S, TCN: S
    TGA: *, TGC: C, TGG: W, TGT: C, TGY: C
    TRA: *
    TTA: L, TTC: F, TTG: L, TTR: L, TTT: F, TTY: F

    YTA: L, YTG: L, YTR: L
</code></pre>
</li>
</ol>
<h2 id="grep">grep</h2>
<p>Usage</p>
<pre><code class="text">search sequences by ID/name/sequence/sequence motifs, mismatch allowed

Attentions:
  1. Unlike POSIX/GNU grep, we compare the pattern to the whole target
     (ID/full header) by default. Please switch &quot;-r/--use-regexp&quot; on
     for partly matching.
  2. While when searching by sequences, only positive strand is searched,
     and it's partly matching. 
     Mismatch is allowed using flag &quot;-m/--max-mismatch&quot;,
     but it's not fast enough for large genome like human genome.
     Though, it's fast enough for microbial genomes.
  3. The order of sequences in result is consistent with that in original
     file, not the order of the query patterns. 
     But for FASTA file, you can use:
        seqkit faidx seqs.fasta --infile-list IDs.txt

You can specify the sequence region for searching with flag -R (--region).
The definition of region is 1-based and with some custom design.

Examples:

 1-based index    1 2 3 4 5 6 7 8 9 10
negative index    0-9-8-7-6-5-4-3-2-1
           seq    A C G T N a c g t n
           1:1    A
           2:4      C G T
         -4:-2                c g t
         -4:-1                c g t n
         -1:-1                      n
          2:-2      C G T N a c g t
          1:-1    A C G T N a c g t n
          1:12    A C G T N a c g t n
        -12:-1    A C G T N a c g t n

Usage:
  seqkit grep [flags]

Flags:
  -n, --by-name               match by full name instead of just id
  -s, --by-seq                search subseq on seq, only positive strand is searched, and mismatch allowed using flag -m/--max-mismatch
  -d, --degenerate            pattern/motif contains degenerate base
      --delete-matched        delete a pattern right after being matched, this keeps the firstly matched data and speedups when using regular expressions
  -h, --help                  help for grep
  -i, --ignore-case           ignore case
  -v, --invert-match          invert the sense of matching, to select non-matching records
  -m, --max-mismatch int      max mismatch when matching by seq. For large genomes like human genome, using mapping/alignment tools would be faster
  -p, --pattern strings       search pattern (multiple values supported. Attention: use double quotation marks for patterns containing comma, e.g., -p '&quot;A{2,}&quot;'))
  -f, --pattern-file string   pattern file (one record per line)
  -R, --region string         specify sequence region for searching. e.g 1:12 for first 12 bases, -12:-1 for last 12 bases
  -r, --use-regexp            patterns are regular expression

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Extract human hairpins (i.e. sequences with name starting with <code>hsa</code>)</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit grep -r -p ^hsa
&gt;hsa-let-7a-1 MI0000060 Homo sapiens let-7a-1 stem-loop
UGGGAUGAGGUAGUAGGUUGUAUAGUUUUAGGGUCACACCCACCACUGGGAGAUAACUAU
ACAAUCUACUGUCUUUCCUA
&gt;hsa-let-7a-2 MI0000061 Homo sapiens let-7a-2 stem-loop
AGGUUGAGGUAGUAGGUUGUAUAGUUUAGAAUUACAUCAAGGGAGAUAACUGUACAGCCU
CCUAGCUUUCCU
</code></pre>
</li>
<li>
<p>Remove human and mice hairpins.</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit grep -r -p ^hsa -p ^mmu -v
</code></pre>
</li>
<li>
<p>Extract new entries by information from miRNA.diff.gz</p>
<ol>
<li>
<p>Get IDs of new entries.</p>
<pre><code>$ zcat miRNA.diff.gz | grep ^# -v | grep NEW | cut -f 2 &gt; list
$ more list
cfa-mir-486
cfa-mir-339-1
pmi-let-7
</code></pre>
</li>
<li>
<p>Extract by ID list file</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit grep -f list &gt; new.fa
</code></pre>
</li>
</ol>
</li>
<li>
<p>Extract sequences containing AGGCG</p>
<pre><code>$ cat hairpin.fa.gz | seqkit grep -s -i -p aggcg
</code></pre>
</li>
<li>
<p>Extract sequences containing AGGCG (allow mismatch)</p>
<pre><code>$ time cat hairpin.fa.gz | seqkit grep -s -i -p aggcg | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   RNA      1,181  145,789       49    123.4    2,354

real    0m0.058s
user    0m0.100s
sys     0m0.017s

$ time cat hairpin.fa.gz | seqkit grep -s -i -p aggcg -m 1 | seqkit stats
file  format  type  num_seqs    sum_len  min_len  avg_len  max_len
-     FASTA   RNA     17,168  1,881,005       39    109.6    2,354

real    0m0.864s
user    0m0.941s
sys     0m0.014s
</code></pre>
</li>
<li>
<p>Extract sequences starting with AGGCG</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit grep -s -r -i -p ^aggcg
</code></pre>
</li>
<li>
<p>Extract sequences with TTSAA (AgsI digest site) in SEQUENCE. Base S stands for C or G.</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit grep -s -d -i -p TTSAA
</code></pre>
<p>It's equal to but simpler than:</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit grep -s -r -i -p TT[CG]AA
</code></pre>
</li>
<li>
<p>Specify sequence regions for searching. e.g., leading 30 bases.</p>
<pre><code>$ seqkit grep -s -R 1:30 -i -r -p GCTGG
</code></pre>
</li>
</ol>
<h2 id="locate">locate</h2>
<p>Usage</p>
<pre><code class="text">locate subsequences/motifs, mismatch allowed

Motifs could be EITHER plain sequence containing &quot;ACTGN&quot; OR regular
expression like &quot;A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)&quot; for ORFs.
Degenerate bases like &quot;RYMM..&quot; are also supported by flag -d.

By default, motifs are treated as regular expression.
When flag -d given, regular expression may be wrong.
For example: &quot;\w&quot; will be wrongly converted to &quot;\[AT]&quot;.

Mismatch is allowed using flag &quot;-m/--max-mismatch&quot;,
but it's not fast enough for large genome like human genome.
Though, it's fast enough for microbial genomes.

Usage:
  seqkit locate [flags]

Flags:
      --bed                       output in BED6 format
  -d, --degenerate                pattern/motif contains degenerate base
      --gtf                       output in GTF format
  -h, --help                      help for locate
  -M, --hide-matched              do not show matched sequences
  -i, --ignore-case               ignore case
  -m, --max-mismatch int          max mismatch when matching by seq. For large genomes like human genome, using mapping/alignment tools would be faster
  -G, --non-greedy                non-greedy mode, faster but may miss motifs overlapping with others
  -P, --only-positive-strand      only search on positive strand
  -p, --pattern strings           pattern/motif (multiple values supported. Attention: use double quotation marks for patterns containing comma, e.g., -p '&quot;A{2,}&quot;')
  -f, --pattern-file string       pattern/motif file (FASTA format)
  -F, --use-fmi                   use FM-index for much faster search of lots of sequence patterns
  -r, --use-regexp                patterns/motifs are regular expression
  -V, --validate-seq-length int   length of sequence to validate (0 for whole seq) (default 10000)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Locating subsequences (mismatch allowed)</p>
<pre><code>$ cat t.fa
&gt;seq
agctggagctacc

$ cat t.fa \
  | seqkit locate -p agc \
  | csvtk pretty -t
seqID   patternName   pattern   strand   start   end   matched
seq     agc           agc       +        1       3     agc
seq     agc           agc       +        7       9     agc
seq     agc           agc       -        8       10    agc
seq     agc           agc       -        2       4     agc

# do not show matched sequences
$ cat t.fa \
  | seqkit locate -p agc -M \
  | csvtk pretty -t
seqID   patternName   pattern   strand   start   end
seq     agc           agc       +        1       3
seq     agc           agc       +        7       9
seq     agc           agc       -        8       10
seq     agc           agc       -        2       4

# max mismatch: 1
$ cat t.fa \
  | seqkit locate -p agc -m 1 \
  | csvtk pretty -t
seqID   patternName     pattern strand  start   end    matched
seq     agc           agc       +        1       3     agc
seq     agc           agc       +        7       9     agc
seq     agc           agc       +        11      13    acc
seq     agc           agc       -        8       10    agc
seq     agc           agc       -        2       4     agc

# max mismatch: 2
$ cat t.fa \
  | seqkit locate -p agc -m 2 \
  | csvtk pretty -t
seqID   patternName   pattern   strand   start   end   matched
seq     agc           agc       +        1       3     agc
seq     agc           agc       +        4       6     tgg
seq     agc           agc       +        5       7     gga
seq     agc           agc       +        7       9     agc
seq     agc           agc       +        10      12    tac
seq     agc           agc       +        11      13    acc
seq     agc           agc       -        11      13    ggt
seq     agc           agc       -        8       10    agc
seq     agc           agc       -        6       8     ctc
seq     agc           agc       -        5       7     tcc
seq     agc           agc       -        2       4     agc
</code></pre>
</li>
<li>
<p>Locate ORFs.</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit locate -i -p "A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)" -r \
    | head -n 4 \
    | csvtk pretty -t
seqID       patternName                        pattern                            strand   start   end   matched
cel-lin-4   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   +        1       36    AUGCUUCCGGCCUGUUCCCUGAGACCUCAAGUGUGA
cel-mir-1   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   +        54      95    AUGGAUAUGGAAUGUAAAGAAGUAUGUAGAACGGGGUGGUAG
cel-mir-1   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   -        43      51    AUGAUAUAG
cel-mir-1   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   A[TU]G(?:.{3})+?[TU](?:AG|AA|GA)   -        30      41    AUGGGCAUGUAA
</code></pre>
</li>
<li>
<p>Locate Motif.</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit locate -i -d -p AUGGACUN \
    | head -n 4 \
    | csvtk pretty -t 
seqID         patternName   pattern    strand   start   end   matched
cel-mir-58a   AUGGACUN      AUGGACUN   +        81      88    AUGGACUG
ath-MIR163    AUGGACUN      AUGGACUN   -        122     129   AUGGACUC
cel-mir-270   AUGGACUN      AUGGACUN   +        84      91    AUGGACUG
</code></pre>
<p>Notice that <code>seqkit grep</code> only searches in positive strand, but <code>seqkit loate</code> could recognize both strand.</p>
</li>
<li>
<p>Output in <code>GTF</code> or <code>BED6</code> format, which you can use in <code>seqkit subseq</code></p>
<pre><code>$ zcat hairpin.fa.gz | seqkit locate -i -d -p AUGGACUN --bed
cel-mir-58a     80      88      AUGGACUN        0       +
ath-MIR163      121     129     AUGGACUN        0       -

$ zcat hairpin.fa.gz | seqkit locate -i -d -p AUGGACUN --gtf
cel-mir-58a     SeqKit  location        81      88      0       +       .       gene_id "AUGGACUN";
ath-MIR163      SeqKit  location        122     129     0       -       .       gene_id "AUGGACUN";
</code></pre>
</li>
<li>
<p>greedy mode (default)</p>
<pre><code> $ echo -e '&gt;seq\nACGACGACGA' | seqkit locate -p ACGA | csvtk -t pretty
 seqID   patternName   pattern   strand   start   end   matched
 seq     ACGA          ACGA      +        1       4     ACGA
 seq     ACGA          ACGA      +        4       7     ACGA
 seq     ACGA          ACGA      +        7       10    ACGA
</code></pre>
</li>
<li>
<p>non-greedy mode (<code>-G</code>)</p>
<pre><code>$ echo -e '&gt;seq\nACGACGACGA' | seqkit locate -p ACGA -G | csvtk -t pretty
seqID   patternName   pattern   strand   start   end   matched
seq     ACGA          ACGA      +        1       4     ACGA
seq     ACGA          ACGA      +        7       10    ACGA
</code></pre>
</li>
</ol>
<h2 id="fish">fish</h2>
<p>Usage</p>
<pre><code class="text">look for short sequences in larger sequences using local alignment

Attention:
  1. output coordinates are BED-like 0-based, left-close and right-open.
  2. alignment information are printed to STDERR.

Usage:
  seqkit fish [flags]

Flags:
  -a, --all                       search all
  -p, --aln-params string         alignment parameters in format &quot;&lt;match&gt;,&lt;mismatch&gt;,&lt;gap_open&gt;,&lt;gap_extend&gt;&quot; (default &quot;4,-4,-2,-1&quot;)
  -h, --help                      help for fish
  -i, --invert                    print out references not matching with any query
  -q, --min-qual float            minimum mapping quality (default 5)
  -b, --out-bam string            save aligmnets to this BAM file (memory intensive)
  -x, --pass                      pass through mode (write input to stdout)
  -g, --print-aln                 print sequence alignments
  -D, --print-desc                print full sequence header
  -f, --query-fastx string        query fasta
  -F, --query-sequences string    query sequences
  -r, --ranges string             target ranges, for example: &quot;:10,30:40,-20:&quot;
  -s, --stranded                  search + strand only
  -v, --validate-seq              validate bases according to the alphabet
  -V, --validate-seq-length int   length of sequence to validate (0 for whole seq) (default 10000)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Find best local alignment of a short sequence in reads in a fasta file, print results as tabular</p>
<pre><code>$ seqkit fish -q 4.7 -F GGCGGCTGTGACC -g mouse-p53-cds.fna
</code></pre>
</li>
<li>
<p>Compare to <code>seqkit locate</code>:</p>
<pre><code>$ echo -e '&gt;seq\nACGACGACGA' \
    | seqkit locate -p ACGA -G | csvtk -t pretty
seqID   patternName   pattern   strand   start   end   matched
seq     ACGA          ACGA      +        1       4     ACGA
seq     ACGA          ACGA      +        7       10    ACGA

$ echo -e '&gt;seq\nACGACGACGA' \
    | seqkit fish -F ACGA -a 2&gt;&amp;1 | csvtk -t pretty 
Ref   RefStart   RefEnd   Query   QueryStart   QueryEnd   Strand   MapQual   RawScore   Acc      ClipAcc   QueryCov
seq   6          10       q0      0            4          +        60.00     16         100.00   100.00    100.00
seq   0          4        q0      0            4          +        60.00     16         100.00   100.00    100.00
</code></pre>
</li>
<li>
<p>Find all local alignment of a short sequences in reads in a fasta file, print results as tabular and save as BAM</p>
<pre><code>seqkit fish -a -q 4.67 -f query.fas -b alignments.bam -g mouse-p53-cds.fna
</code></pre>
</li>
</ol>
<h2 id="amplicon">amplicon</h2>
<p>Usage</p>
<pre><code class="text">
retrieve amplicon (or specific region around it) via primer(s).

Examples:
  0. no region given.

                    F
        -----===============-----
             F             R
        -----=====-----=====-----

             ===============         amplicon

  1. inner region (-r x:y).

                    F
        -----===============-----
             1 3 5                    x/y
                      -5-3-1          x/y
             F             R
        -----=====-----=====-----     x:y

             ===============          1:-1
             =======                  1:7
               =====                  3:7
                  =====               6:10
                  =====             -10:-6
                     =====           -7:-3
                                     -x:y (invalid)

  2. flanking region (-r x:y -f)

                    F
        -----===============-----
         -3-1                        x/y
                            1 3 5    x/y
             F             R
        -----=====-----=====-----

        =====                        -5:-1
        ===                          -5:-3
                            =====     1:5
                              ===     3:5
            =================        -1:1
        =========================    -5:5
                                      x:-y (invalid)

Usage:
  seqkit amplicon [flags]

Flags:
  -f, --flanking-region    region is flanking region
  -F, --forward string     forward primer
  -h, --help               help for amplicon
  -m, --max-mismatch int   max mismatch when matching primers
  -r, --region string      specify region to return. type &quot;seqkit amplicon -h&quot; for detail
  -R, --reverse string     reverse primer
  -s, --strict             strict mode, i.e., discarding seqs not fully matching (shorter) given region range
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>No region given.</p>
<pre><code>$ echo -ne "&gt;seq\nacgcccactgaaatga\n" 
&gt;seq
acgcccactgaaatga

$ echo -ne "&gt;seq\nacgcccactgaaatga\n" \
    | seqkit amplicon -F ccc -R ttt
&gt;seq
cccactgaaa
</code></pre>
</li>
<li>
<p>Inner region</p>
<pre><code># region right behind forward primer
$ echo -ne "&gt;seq\nacgcccactgaaatga\n" \
    | seqkit amplicon -F ccc -R ttt -r 4:7
&gt;seq
actg

# more common case is triming primers
$ echo -ne "&gt;seq\nacgcccactgaaatga\n" \
    | seqkit amplicon -F ccc -R ttt -r 4:-4
&gt;seq
actg
</code></pre>
</li>
<li>
<p>flanking region</p>
<pre><code># in one of my sequencing data, I only care about 
# region downstream of forward primer
$ echo -ne "&gt;seq\nacgcccactgaaatga\n" \
    | seqkit amplicon -F ccc -f -r 3:6
&gt;seq
tgaa

# if given region if out scope of sequence. e.g,
# 2-5bp downstream of aaa, we can get part of region (2-4) by default
$ echo -ne "&gt;seq\nacgcccactgaaatga\n" \
    | seqkit amplicon -F aaa -f -r 2:5
&gt;seq
ga

# you can also use strict mode to discard those cases
$ echo -ne "&gt;seq\nacgcccactgaaatga\n" \
    | seqkit amplicon -F aaa -f -r 2:5 -s
</code></pre>
</li>
</ol>
<h2 id="duplicate">duplicate</h2>
<p>Usage</p>
<pre><code class="text">duplicate sequences N times

You may need &quot;seqkit rename&quot; to make the the sequence IDs unique.

Usage:
  seqkit duplicate [flags]

Aliases:
  duplicate, dup

Flags:
  -h, --help        help for duplicate
  -n, --times int   duplication number (default 1)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Data</p>
<pre><code>$ cat tests/hairpin.fa | seqkit head -n 1
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
</code></pre>
</li>
<li>
<p>Duplicate 2 times</p>
<pre><code>$ cat tests/hairpin.fa | seqkit head -n 1 \
    | seqkit duplicate -n 2
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
</code></pre>
</li>
<li>
<p>use <code>seqkit rename</code> to make the the sequence IDs unique.</p>
<pre><code>$ cat tests/hairpin.fa | seqkit head -n 1 \
    | seqkit duplicate -n 2 | seqkit rename
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
&gt;cel-let-7_2 cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
</code></pre>
</li>
</ol>
<h2 id="rmdup">rmdup</h2>
<p>Usage</p>
<pre><code class="text">remove duplicated sequences by id/name/sequence

Usage:
  seqkit rmdup [flags]

Flags:
  -n, --by-name                by full name instead of just id
  -s, --by-seq                 by seq
  -D, --dup-num-file string    file to save number and list of duplicated seqs
  -d, --dup-seqs-file string   file to save duplicated seqs
  -h, --help                   help for rmdup
  -i, --ignore-case            ignore case

</code></pre>

<p>Examples</p>
<p>Similar to <code>common</code>.</p>
<ol>
<li>
<p>General use</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit rmdup -s -o clean.fa.gz
[INFO] 2226 duplicated records removed

$ zcat reads_1.fq.gz | seqkit rmdup -s -o clean.fa.gz
[INFO] 1086 duplicated records removed
</code></pre>
</li>
<li>
<p>Save duplicated sequences to file</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit rmdup -s -i -o clean.fa.gz -d duplicated.fa.gz -D duplicated.detail.txt

$ cat duplicated.detail.txt   # here is not the entire list
3   hsa-mir-424, mml-mir-424, ppy-mir-424
3   hsa-mir-342, mml-mir-342, ppy-mir-342
2   ngi-mir-932, nlo-mir-932
2   ssc-mir-9784-1, ssc-mir-9784-2
</code></pre>
</li>
</ol>
<h2 id="common">common</h2>
<p>Usage</p>
<pre><code class="text">find common sequences of multiple files by id/name/sequence

Note:
    1. 'seqkit common' is designed to support 2 and MORE files.
    2. For 2 files, 'seqkit grep' is much faster and consumes lesser memory:
         seqkit grep -f &lt;(seqkit seq -n -i small.fq.gz) big.fq.gz # by seq ID
         seqkit grep -s -f &lt;(seqkit seq -s small.fq.gz) big.fq.gz # by seq
    3. Some records in one file may have same sequences/IDs. They will ALL be
       retrieved if the sequence/ID was shared in multiple files.
       So the records number may be larger than that of the smallest file.

Usage:
  seqkit common [flags]

Flags:
  -n, --by-name       match by full name instead of just id
  -s, --by-seq        match by sequence
  -h, --help          help for common
  -i, --ignore-case   ignore case

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>By ID (default)</p>
<pre><code>seqkit common file*.fa -o common.fasta
</code></pre>
</li>
<li>
<p>By full name</p>
<pre><code>seqkit common file*.fa -n -o common.fasta
</code></pre>
</li>
<li>
<p>By sequence</p>
<pre><code>seqkit common file*.fa -s -i -o common.fasta
</code></pre>
</li>
</ol>
<h2 id="split">split</h2>
<p>Usage</p>
<pre><code class="text">split sequences into files by name ID, subsequence of given region,
part size or number of parts.

Please use &quot;seqkit split2&quot; for paired- and single-end FASTQ.

The definition of region is 1-based and with some custom design.

Examples:

 1-based index    1 2 3 4 5 6 7 8 9 10
negative index    0-9-8-7-6-5-4-3-2-1
           seq    A C G T N a c g t n
           1:1    A
           2:4      C G T
         -4:-2                c g t
         -4:-1                c g t n
         -1:-1                      n
          2:-2      C G T N a c g t
          1:-1    A C G T N a c g t n
          1:12    A C G T N a c g t n
        -12:-1    A C G T N a c g t n

Usage:
  seqkit split [flags]

Flags:
  -i, --by-id              split squences according to sequence ID
  -p, --by-part int        split sequences into N parts
  -r, --by-region string   split squences according to subsequence of given region. e.g 1:12 for first 12 bases, -12:-1 for last 12 bases. type &quot;seqkit split -h&quot; for more examples
  -s, --by-size int        split sequences into multi parts with N sequences
  -d, --dry-run            dry run, just print message and no files will be created.
  -f, --force              overwrite output directory
  -h, --help               help for split
  -k, --keep-temp          keep tempory FASTA and .fai file when using 2-pass mode
  -O, --out-dir string     output directory (default value is $infile.split)
  -2, --two-pass           two-pass mode read files twice to lower memory usage. (only for FASTA format)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Split sequences into parts with at most 10000 sequences</p>
<pre><code>$ seqkit split hairpin.fa.gz -s 10000
[INFO] split into 10000 seqs per file
[INFO] write 10000 sequences to file: hairpin.fa.part_001.gz
[INFO] write 10000 sequences to file: hairpin.fa.part_002.gz
[INFO] write 8645 sequences to file: hairpin.fa.part_003.gz
</code></pre>
</li>
<li>
<p>Split sequences into 4 parts</p>
<pre><code>$ seqkit split hairpin.fa.gz -p 4
[INFO] split into 4 parts
[INFO] read sequences ...
[INFO] read 28645 sequences
[INFO] write 7162 sequences to file: hairpin.fa.part_001.gz
[INFO] write 7162 sequences to file: hairpin.fa.part_002.gz
[INFO] write 7162 sequences to file: hairpin.fa.part_003.gz
[INFO] write 7159 sequences to file: hairpin.fa.part_004.gz
</code></pre>
<p><strong><em>To reduce memory usage when spliting big file, we should alwasy use flag <code>--two-pass</code></em></strong></p>
<pre><code>$ seqkit split hairpin.fa.gz -p 4 -2
[INFO] split into 4 parts
[INFO] read and write sequences to tempory file: hairpin.fa.gz.fa ...
[INFO] create and read FASTA index ...
[INFO] read sequence IDs from FASTA index ...
[INFO] 28645 sequences loaded
[INFO] write 7162 sequences to file: hairpin.part_001.fa.gz
[INFO] write 7162 sequences to file: hairpin.part_002.fa.gz
[INFO] write 7162 sequences to file: hairpin.part_003.fa.gz
[INFO] write 7159 sequences to file: hairpin.part_004.fa.gz
</code></pre>
</li>
<li>
<p>Split sequences by species. i.e. by custom IDs (first three letters)</p>
<pre><code>$ seqkit split hairpin.fa.gz -i --id-regexp "^([\w]+)\-" -2
[INFO] split by ID. idRegexp: ^([\w]+)\-
[INFO] read and write sequences to tempory file: hairpin.fa.gz.fa ...
[INFO] create and read FASTA index ...
[INFO] create FASTA index for hairpin.fa.gz.fa
[INFO] read sequence IDs from FASTA index ...
[INFO] 28645 sequences loaded
[INFO] write 48 sequences to file: hairpin.id_cca.fa.gz
[INFO] write 3 sequences to file: hairpin.id_hci.fa.gz
[INFO] write 106 sequences to file: hairpin.id_str.fa.gz
[INFO] write 1 sequences to file: hairpin.id_bkv.fa.gz
...
</code></pre>
</li>
<li>
<p>Split sequences by sequence region (for example, sequence barcode)</p>
<pre><code>$ seqkit split hairpin.fa.gz -r 1:3 -2
[INFO] split by region: 1:3
[INFO] read and write sequences to tempory file: hairpin.fa.gz.fa ...
[INFO] read sequence IDs and sequence region from FASTA file ...
[INFO] create and read FASTA index ...
[INFO] write 463 sequences to file: hairpin.region_1:3_AUG.fa.gz
[INFO] write 349 sequences to file: hairpin.region_1:3_ACU.fa.gz
[INFO] write 311 sequences to file: hairpin.region_1:3_CGG.fa.gz
</code></pre>
<p>Sequence suffix could be defined as <code>-r -12:-1</code></p>
</li>
</ol>
<h2 id="split2">split2</h2>
<p>Usage</p>
<pre><code class="text">split sequences into files by part size or number of parts

This command supports FASTA and paired- or single-end FASTQ with low memory
occupation and fast speed.

The file extensions of output are automatically detected and created
according to the input files.

Usage:
  seqkit split2 [flags]

Flags:
  -p, --by-part int      split sequences into N parts
  -s, --by-size int      split sequences into multi parts with N sequences
  -f, --force            overwrite output directory
  -h, --help             help for split2
  -O, --out-dir string   output directory (default value is $infile.split)
  -1, --read1 string     read1 file
  -2, --read2 string     read2 file
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Split sequences into parts with at most 10000 sequences</p>
<pre><code>$ seqkit split2 hairpin.fa.gz -s 10000 -f
[INFO] split into 10000 seqs per file
[INFO] write 10000 sequences to file: hairpin.fa.part_001.gz
[INFO] write 10000 sequences to file: hairpin.fa.part_002.gz
[INFO] write 8645 sequences to file: hairpin.fa.part_003.gz
</code></pre>
</li>
<li>
<p>Split sequences into 4 parts</p>
<pre><code>$ seqkit split hairpin.fa.gz -p 4 -f
[INFO] split into 4 parts
[INFO] read sequences ...
[INFO] read 28645 sequences
[INFO] write 7162 sequences to file: hairpin.fa.gz.split/hairpin.part_001.fa.gz
[INFO] write 7162 sequences to file: hairpin.fa.gz.split/hairpin.part_002.fa.gz
[INFO] write 7162 sequences to file: hairpin.fa.gz.split/hairpin.part_003.fa.gz
[INFO] write 7159 sequences to file: hairpin.fa.gz.split/hairpin.part_004.fa.gz
</code></pre>
</li>
<li>
<p>For FASTQ files (paired-end)</p>
<pre><code>$ seqkit split2 -1 reads_1.fq.gz -2 reads_2.fq.gz -p 2 -O out -f
[INFO] split seqs from reads_1.fq.gz and reads_2.fq.gz
[INFO] split into 2 parts
[INFO] write 1250 sequences to file: out/reads_2.part_001.fq.gz
[INFO] write 1250 sequences to file: out/reads_2.part_002.fq.gz
[INFO] write 1250 sequences to file: out/reads_1.part_001.fq.gz
[INFO] write 1250 sequences to file: out/reads_1.part_002.fq.gz
</code></pre>
</li>
<li>
<p>For FASTA files (single-end)</p>
<pre><code>$ seqkit split2 -1 reads_1.fq.gz reads_2.fq.gz -p 2 -O out -f
[INFO] flag -1/--read1 given, ignore: reads_2.fq.gz
[INFO] split seqs from reads_1.fq.gz
[INFO] split into 2 parts
[INFO] write 1250 sequences to file: out/reads_1.part_001.fq.gz
[INFO] write 1250 sequences to file: out/reads_1.part_002.fq.gz

$ seqkit split2 reads_1.fq.gz -p 2 -O out -f
[INFO] split seqs from reads_1.fq.gz
[INFO] split into 2 parts
[INFO] write 1250 sequences to file: out/reads_1.part_001.fq.gz
[INFO] write 1250 sequences to file: out/reads_1.part_002.fq.gz
</code></pre>
</li>
</ol>
<h2 id="sample">sample</h2>
<p>Usage</p>
<pre><code class="text">sample sequences by number or proportion.

Usage:
  seqkit sample [flags]

Flags:
  -n, --number int         sample by number (result may not exactly match)
  -p, --proportion float   sample by proportion
  -s, --rand-seed int      rand seed (default 11)
  -2, --two-pass           2-pass mode read files twice to lower memory usage. Not allowed when reading from stdin

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Sample by proportion</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit sample -p 0.1 -o sample.fa.gz
[INFO] sample by proportion
[INFO] 2814 sequences outputed
</code></pre>
</li>
<li>
<p>Sample by number</p>
<pre><code>$ zcat hairpin.fa.gz | seqkit sample -n 1000 -o sample.fa.gz
[INFO] sample by number
[INFO] 949 sequences outputed
</code></pre>
<p>949 != 1000 ??? see <a href="http:bioinf.shenwei.me/seqkit/note/#effect-of-random-seed-on-results-of-seqkit-sample">Effect of random seed on results of <code>seqkit sample</code></a></p>
<p><strong><em>To reduce memory usage when spliting big file, we could use flag <code>--two-pass</code></em></strong></p>
<p><strong><em>We can also use <code>seqkit sample -p</code> followed with <code>seqkit head -n</code>:</em></strong></p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit sample -p 0.1 \
    | seqkit head -n 1000 -o sample.fa.gz
</code></pre>
</li>
<li>
<p>Set rand seed to reproduce the result</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit sample -p 0.1 -s 11
</code></pre>
</li>
<li>
<p>Most of the time, we could shuffle after sampling</p>
<pre><code>$ zcat hairpin.fa.gz \
    | seqkit sample -p 0.1 \
    | seqkit shuffle -o sample.fa.gz
</code></pre>
</li>
</ol>
<p>Note that when sampling on FASTQ files, make sure using same random seed by
flag <code>-s</code> (<code>--rand-seed</code>)</p>
<h2 id="head">head</h2>
<p>Usage</p>
<pre><code class="text">print first N FASTA/Q records

Usage:
  seqkit head [flags]

Flags:
  -n, --number int   print first N FASTA/Q records (default 10)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>FASTA</p>
<pre><code>$ seqkit head -n 1 hairpin.fa.gz
&gt;cel-let-7 MI0000001 Caenorhabditis elegans let-7 stem-loop
UACACUGUGGAUCCGGUGAGGUAGUAGGUUGUAUAGUUUGGAAUAUUACCACCGGUGAAC
UAUGCAAUUUUCUACCUUACCGGAGACAGAACUCUUCGA
</code></pre>
</li>
<li>
<p>FASTQ</p>
<pre><code>$ seqkit head -n 1 reads_1.fq.gz
@HWI-D00523:240:HF3WGBCXX:1:1101:2574:2226 1:N:0:CTGTAG
TGAGGAATATTGGTCAATGGGCGCGAGCCTGAACCAGCCAAGTAGCGTGAAGGATGACTGCCCTACGGGTTGTAA
+
HIHIIIIIHIIHGHHIHHIIIIIIIIIIIIIIIHHIIIIIHHIHIIIIIGIHIIIIHHHHHHGHIHIIIIIIIII
</code></pre>
</li>
</ol>
<h2 id="range">range</h2>
<p>Usage</p>
<pre><code class="text">print FASTA/Q records in a range (start:end)

Usage:
  seqkit range [flags]

Flags:
  -h, --help           help for range
  -r, --range string   range. e.g., 1:12 for first 12 records (head -n 12), -12:-1 for last 12 records (tail -n 12)
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>leading N records (head)</p>
<pre><code>$ cat tests/hairpin.fa | seqkit head -n 100 | md5sum
f65116af7d9298d93ba4b3d19077bbf1  -
$ cat tests/hairpin.fa | seqkit range -r 1:100 | md5sum
f65116af7d9298d93ba4b3d19077bbf1  -
</code></pre>
</li>
<li>
<p>last N records (tail)</p>
<pre><code>$ cat tests/hairpin.fa | seqkit range -r -100:-1 | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   RNA        100    8,656       58     86.6      172
</code></pre>
</li>
<li>
<p>Other ranges</p>
<pre><code>$ cat tests/hairpin.fa | seqkit range -r 101:150 | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   RNA         50    3,777       63     75.5       96

$ cat tests/hairpin.fa | seqkit range -r -100:-2 | seqkit stats
file  format  type  num_seqs  sum_len  min_len  avg_len  max_len
-     FASTA   RNA         99    8,484       58     85.7      146
</code></pre>
</li>
</ol>
<h2 id="replace">replace</h2>
<p>Usage</p>
<pre><code class="text">replace name/sequence by regular expression.

Note that the replacement supports capture variables.
e.g. $1 represents the text of the first submatch.
ATTENTION: use SINGLE quote NOT double quotes in *nix OS.

Examples: Adding space to all bases.

    seqkit replace -p &quot;(.)&quot; -r '$1 ' -s

Or use the \ escape character.

    seqkit replace -p &quot;(.)&quot; -r &quot;\$1 &quot; -s

more on: http://bioinf.shenwei.me/seqkit/usage/#replace

Special replacement symbols (only for replacing name not sequence):

    {nr}    Record number, starting from 1
    {kv}    Corresponding value of the key (captured variable $n) by key-value file,
            n can be specified by flag -I (--key-capt-idx) (default: 1)

Usage:
  seqkit replace [flags]

Flags:
  -s, --by-seq                 replace seq
  -h, --help                   help for replace
  -i, --ignore-case            ignore case
  -K, --keep-key               keep the key as value when no value found for the key (only for sequence name)
  -I, --key-capt-idx int       capture variable index of key (1-based) (default 1)
  -m, --key-miss-repl string   replacement for key with no corresponding value
  -k, --kv-file string         tab-delimited key-value file for replacing key with value when using &quot;{kv}&quot; in -r (--replacement) (only for sequence name)
      --nr-width int           minimum width for {nr} in flag -r/--replacement. e.g., formating &quot;1&quot; to &quot;001&quot; by --nr-width 3 (default 1)
  -p, --pattern string         search regular expression
  -r, --replacement string     replacement. supporting capture variables.  e.g. $1 represents the text of the first submatch. ATTENTION: for *nix OS, use SINGLE quote NOT double quotes or use the \ escape character. Record number is also supported by &quot;{nr}&quot;.use ${1} instead of $1 when {kv} given!

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Remove descriptions</p>
<pre><code>$ echo -e "&gt;seq1 abc-123\nACGT-ACGT"
&gt;seq1 abc-123
ACGT-ACGT

$ echo -e "&gt;seq1 abc-123\nACGT-ACGT" \
    | seqkit replace -p "\s.+"
&gt;seq1
ACGT-ACGT
</code></pre>
</li>
<li>
<p>Replace "-" with "="</p>
<pre><code>$ echo -e "&gt;seq1 abc-123\nACGT-ACGT" \
    | seqkit replace -p "\-" -r '='
&gt;seq1 abc=123
ACGT-ACGT
</code></pre>
</li>
<li>
<p>Remove gaps in sequences.</p>
<pre><code>$ echo -e "&gt;seq1 abc-123\nACGT-ACGT" \
    | seqkit replace -p " |-" -s
&gt;seq1 abc-123
ACGTACGT
</code></pre>
</li>
<li>
<p>Add space to every base. <strong>ATTENTION: use SINGLE quote NOT double quotes in *nix OS</strong></p>
<pre><code>$ echo -e "&gt;seq1 abc-123\nACGT-ACGT" \
    | seqkit replace -p "(.)" -r '$1 ' -s
&gt;seq1 abc-123
A C G T - A C G T
</code></pre>
</li>
<li>
<p>Transpose sequence with <a href="https://github.com/shenwei356/csvtk">csvtk</a></p>
<pre><code>$ echo -e "&gt;seq1\nACTGACGT\n&gt;seq2\nactgccgt" \
    | seqkit replace -p "(.)" -r     "\$1 " -s \
    | seqkit seq -s -u \
    | csvtk space2tab \
    | csvtk -t transpose
A       A
C       C
T       T
G       G
A       C
C       C
G       G
T       T
</code></pre>
</li>
<li>
<p>Rename with number of record</p>
<pre><code>$ echo -e "&gt;abc\nACTG\n&gt;123\nATTT" \
    |  seqkit replace -p .+ -r "seq_{nr}"
&gt;seq_1
ACTG
&gt;seq_2
ATTT

$ echo -e "&gt;abc\nACTG\n&gt;123\nATTT" \
    |  seqkit replace -p .+ -r "seq_{nr}" --nr-width 5
&gt;seq_00001
ACTG
&gt;seq_00002
ATTT
</code></pre>
</li>
<li>
<p>Replace key with value by key-value file</p>
<pre><code>$ more test.fa
&gt;seq1 name1
CCCCAAAACCCCATGATCATGGATC
&gt;seq2 name2
CCCCAAAACCCCATGGCATCATTCA
&gt;seq3 name3
CCCCAAAACCCCATGTTGCTACTAG

$ more alias.txt
name0   ABC
name1   123
name3   Hello
name4   World

$ seqkit replace -p ' (.+)$' -r ' {kv}' -k alias.txt test.fa
[INFO] read key-value file: alias.txt
[INFO] 4 pairs of key-value loaded
&gt;seq1 123
CCCCAAAACCCCATGATCATGGATC
&gt;seq2
CCCCAAAACCCCATGGCATCATTCA
&gt;seq3 Hello
CCCCAAAACCCCATGTTGCTACTAG

$ seqkit replace -p ' (.+)$' -r ' {kv}' -k alias.txt test.fa --keep-key
[INFO] read key-value file: alias.txt
[INFO] 4 pairs of key-value loaded
&gt;seq1 123
CCCCAAAACCCCATGATCATGGATC
&gt;seq2 name2
CCCCAAAACCCCATGGCATCATTCA
&gt;seq3 Hello
CCCCAAAACCCCATGTTGCTACTAG
</code></pre>
</li>
<li>
<p>convert fasta to genbank style</p>
<pre><code>$ cat seq.fa
&gt;seq1
TTTAAAGAGACCGGCGATTCTAGTGAAATCGAACGGGCAGGTCAATTTCCAACCAGCGAT
GACGTAATAGATAGATACAAGGAAGTCATTTTTCTTTTAAAGGATAGAAACGGTTAATGC
TCTTGGGACGGCGCTTTTCTGTGCATAACT
&gt;seq2
AAGGATAGAAACGGTTAATGCTCTTGGGACGGCGCTTTTCTGTGCATAACTCGATGAAGC
CCAGCAATTGCGTGTTTCTCCGGCAGGCAAAAGGTTGTCGAGAACCGGTGTCGAGGCTGT
TTCCTTCCTGAGCGAAGCCTGGGGATGAACG

$ cat seq.fa \
    | seqkit replace -s -p '(\w{10})' -r '$1 ' -w 66 \
    | perl -ne 'if (/^&gt;/) {print; $n=1} \
        else {s/ \r?\n$/\n/; printf "%9d %s", $n, $_; $n+=60;}'
&gt;seq1
        1 TTTAAAGAGA CCGGCGATTC TAGTGAAATC GAACGGGCAG GTCAATTTCC AACCAGCGAT
       61 GACGTAATAG ATAGATACAA GGAAGTCATT TTTCTTTTAA AGGATAGAAA CGGTTAATGC
      121 TCTTGGGACG GCGCTTTTCT GTGCATAACT
&gt;seq2
        1 AAGGATAGAA ACGGTTAATG CTCTTGGGAC GGCGCTTTTC TGTGCATAAC TCGATGAAGC
       61 CCAGCAATTG CGTGTTTCTC CGGCAGGCAA AAGGTTGTCG AGAACCGGTG TCGAGGCTGT
      121 TTCCTTCCTG AGCGAAGCCT GGGGATGAAC G
</code></pre>
</li>
</ol>
<h2 id="rename">rename</h2>
<p>Usage</p>
<pre><code class="text">rename duplicated IDs

Usage:
  seqkit rename [flags]

Flags:
  -n, --by-name             check duplication by full name instead of just id
  -f, --force               overwrite output directory
  -h, --help                help for rename
  -m, --multiple-outfiles   write results into separated files for multiple input files
  -O, --out-dir string      output directory (default &quot;renamed&quot;)

</code></pre>

<p>Examples</p>
<pre><code class="sh">$ echo -e &quot;&gt;a comment\nacgt\n&gt;b comment of b\nACTG\n&gt;a comment\naaaa&quot;
&gt;a comment
acgt
&gt;b comment of b
ACTG
&gt;a comment
aaaa

$ echo -e &quot;&gt;a comment\nacgt\n&gt;b comment of b\nACTG\n&gt;a comment\naaaa&quot; \
    | seqkit rename
&gt;a comment
acgt
&gt;b comment of b
ACTG
&gt;a_2 a comment
aaaa
</code></pre>

<h2 id="restart">restart</h2>
<p>Usage</p>
<pre><code class="text">reset start position for circular genome

Examples

    $ echo -e &quot;&gt;seq\nacgtnACGTN&quot;
    &gt;seq
    acgtnACGTN

    $ echo -e &quot;&gt;seq\nacgtnACGTN&quot; | seqkit restart -i 2
    &gt;seq
    cgtnACGTNa

    $ echo -e &quot;&gt;seq\nacgtnACGTN&quot; | seqkit restart -i -2
    &gt;seq
    TNacgtnACG

Usage:
  seqkit restart [flags]

Flags:
  -i, --new-start int   new start position (1-base, supporting negative value counting from the end) (default 1)

</code></pre>

<h2 id="concat">concat</h2>
<p>Usage</p>
<pre><code class="text">concatenate sequences with same ID from multiple files

Example: concatenating leading 2 bases and last 2 bases

    $ cat t.fa
    &gt;test
    ACCTGATGT
    &gt;test2
    TGATAGCTACTAGGGTGTCTATCG

    $ seqkit concat &lt;(seqkit subseq -r 1:2 t.fa) &lt;(seqkit subseq -r -2:-1 t.fa)
    &gt;test
    ACGT
    &gt;test2
    TGCG

Usage:
  seqkit concat [flags]

Flags:
  -h, --help   help for concat

</code></pre>

<h2 id="mutate">mutate</h2>
<p>Usage</p>
<pre><code class="text">edit sequence (point mutation, insertion, deletion)

Attentions:

  1. Mutiple point mutations (-p/--point) are allowed, but only single 
     insertion (-i/--insertion) OR single deletion (-d/--deletion) is allowed.
  2. Point mutation takes place before insertion/deletion.

Notes:

  1. You can choose certain sequences to edit using similar flags in
     'seqkit grep'.

The definition of position is 1-based and with some custom design.

Examples:

 1-based index    1 2 3 4 5 6 7 8 9 10
negative index    0-9-8-7-6-5-4-3-2-1
           seq    A C G T N a c g t n
           1:1    A
           2:4      C G T
         -4:-2                c g t
         -4:-1                c g t n
         -1:-1                      n
          2:-2      C G T N a c g t
          1:-1    A C G T N a c g t n
          1:12    A C G T N a c g t n
        -12:-1    A C G T N a c g t n

Usage:
  seqkit mutate [flags]

Flags:
  -n, --by-name               [match seqs to mutate] match by full name instead of just id
  -d, --deletion string       deletion mutation: deleting subsequence in a range. e.g., -d 1:2 for deleting leading two bases, -d -3:-1 for removing last 3 bases
  -h, --help                  help for mutate
  -I, --ignore-case           [match seqs to mutate] ignore case of search pattern
  -i, --insertion string      insertion mutation: inserting bases behind of given position, e.g., -i 0:ACGT for inserting ACGT at the beginning, -1:* for add * to the end
  -v, --invert-match          [match seqs to mutate] invert the sense of matching, to select non-matching records
      --pattern strings       [match seqs to mutate] search pattern (multiple values supported. Attention: use double quotation marks for patterns containing comma, e.g., -p '&quot;A{2,}&quot;'))
  -f, --pattern-file string   [match seqs to mutate] pattern file (one record per line)
  -p, --point strings         point mutation: changing base at given postion. e.g., -p 2:C for setting 2nd base as C, -p -1:A for change last base as A
  -r, --use-regexp            [match seqs to mutate] search patterns are regular expression

</code></pre>

<p>Examples:</p>
<ol>
<li>
<p>Point mutation:</p>
<pre><code>$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n"
&gt;1
ACTGNactgn
&gt;2
actgnACTGN

# first base
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -p 1:x
[INFO] edit seq: 1
[INFO] edit seq: 2
&gt;1
xCTGNactgn
&gt;2
xctgnACTGN

# 5th base
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -p 5:x --quiet
&gt;1
ACTGxactgn
&gt;2
actgxACTGN

# last base
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -p -1:x --quiet
&gt;1
ACTGNactgx
&gt;2
actgnACTGx

# mutiple locations:

$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -p 1:x -p -1:x --quiet
&gt;1
xCTGNactgx
&gt;2
xctgnACTGx
</code></pre>
</li>
<li>
<p>Deletion</p>
<pre><code># first base
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -d 1:1 --quiet
&gt;1
CTGNactgn
&gt;2
ctgnACTGN

# last 3 bases
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -d -3:-1 --quiet
&gt;1
ACTGNac
&gt;2
actgnAC
</code></pre>
</li>
<li>
<p>Insertion: inserting bases <strong>behind</strong> of given position</p>
<pre><code># at the beginning
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -i 0:xx --quiet
&gt;1
xxACTGNactgn
&gt;2
xxactgnACTGN

# at the end
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -i -1:xx --quiet
&gt;1
ACTGNactgnxx
&gt;2
actgnACTGNxx

# behind of 5th base
$ echo -ne "&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n" \
    | seqkit mutate -i 5:x --quiet
&gt;1
ACTGNxactgn
&gt;2
actgnxACTGN
</code></pre>
</li>
<li>
<p><strong>Choosing which sequences to edit</strong>, using similar flags in <code>seqkit grep</code>.</p>
<pre><code>$ cat tests/hsa.fa
&gt;chr1 1th seq
ACTGNactgn
&gt;chr2 2nd seq
actgnACTGN
&gt;chr11 11th seq
ACTGNACTGN
&gt;MT mitochondrial seq
actgnactgn

# only edit chr1 and chr2
# or cat tests/hsa.fa | seqkit mutate -p -1:X -s chr1 -s chr2
$ cat tests/hsa.fa \
    | seqkit mutate -p -1:X -s chr1,chr2
[INFO] edit seq: chr1 1th seq
[INFO] edit seq: chr2 2nd seq
&gt;chr1 1th seq
ACTGNactgX
&gt;chr2 2nd seq
actgnACTGX
&gt;chr11 11th seq
ACTGNACTGN
&gt;MT mitochondrial seq
actgnactgn

# using regular expression to match.
# e,g., editing all chrosomes:
$ cat tests/hsa.fa \
    | seqkit mutate -p -1:X -r -s chr
[INFO] edit seq: chr1 1th seq
[INFO] edit seq: chr2 2nd seq
[INFO] edit seq: chr11 11th seq
&gt;chr1 1th seq
ACTGNactgX
&gt;chr2 2nd seq
actgnACTGX
&gt;chr11 11th seq
ACTGNACTGX
&gt;MT mitochondrial seq
actgnactgn

# excluding seqs
$ cat tests/hsa.fa \
    | seqkit mutate -p -1:X -s chr1 -s chr2 -v 
[INFO] edit seq: chr11 11th seq
[INFO] edit seq: MT mitochondrial seq
&gt;chr1 1th seq
ACTGNactgn
&gt;chr2 2nd seq
actgnACTGN
&gt;chr11 11th seq
ACTGNACTGX
&gt;MT mitochondrial seq
actgnactgX
</code></pre>
</li>
</ol>
<h2 id="shuffle">shuffle</h2>
<p>Usage</p>
<pre><code class="text">shuffle sequences.

By default, all records will be readed into memory.
For FASTA format, use flag -2 (--two-pass) to reduce memory usage. FASTQ not
supported.

Firstly, seqkit reads the sequence IDs. If the file is not plain FASTA file,
seqkit will write the sequences to tempory files, and create FASTA index.

Secondly, seqkit shuffles sequence IDs and extract sequences by FASTA index.

Usage:
  seqkit shuffle [flags]

Flags:
  -k, --keep-temp       keep tempory FASTA and .fai file when using 2-pass mode
  -s, --rand-seed int   rand seed for shuffle (default 23)
  -2, --two-pass        two-pass mode read files twice to lower memory usage. (only for FASTA format)

</code></pre>

<p>Examples</p>
<ol>
<li>
<p>General use.</p>
<pre><code>$ seqkit shuffle hairpin.fa.gz &gt; shuffled.fa
[INFO] read sequences ...
[INFO] 28645 sequences loaded
[INFO] shuffle ...
[INFO] output ...
</code></pre>
</li>
<li>
<p><strong><em>For big genome, you'd better use two-pass mode</em></strong> so seqkit could use
   FASTA index to reduce memory usage</p>
<pre><code>$ time seqkit shuffle -2 hsa.fa &gt; shuffle.fa
[INFO] create and read FASTA index ...
[INFO] create FASTA index for hsa.fa
[INFO] read sequence IDs from FASTA index ...
[INFO] 194 sequences loaded
[INFO] shuffle ...
[INFO] output ...

real    0m35.080s
user    0m45.521s
sys     0m3.411s
</code></pre>
</li>
</ol>
<p>Note that when sampling on FASTQ files, make sure using same random seed by
flag <code>-s</code> (<code>--rand-seed</code>) for read 1 and 2 files.</p>
<h2 id="sort">sort</h2>
<p>Usage</p>
<pre><code class="text">sort sequences by id/name/sequence/length.

By default, all records will be readed into memory.
For FASTA format, use flag -2 (--two-pass) to reduce memory usage. FASTQ not
supported.

Firstly, seqkit reads the sequence head and length information.
If the file is not plain FASTA file,
seqkit will write the sequences to tempory files, and create FASTA index.

Secondly, seqkit sorts sequence by head and length information
and extracts sequences by FASTA index.

Usage:
  seqkit sort [flags]

Flags:
  -l, --by-length               by sequence length
  -n, --by-name                 by full name instead of just id
  -s, --by-seq                  by sequence
  -i, --ignore-case             ignore case
  -k, --keep-temp               keep tempory FASTA and .fai file when using 2-pass mode
  -N, --natural-order           sort in natural order, when sorting by IDs/full name
  -r, --reverse                 reverse the result
  -L, --seq-prefix-length int   length of sequence prefix on which seqkit sorts by sequences (0 for whole sequence) (default 10000)
  -2, --two-pass                two-pass mode read files twice to lower memory usage. (only for FASTA format)

</code></pre>

<p>Examples</p>
<p><strong><em>For FASTA format, use flag -2 (--two-pass) to reduce memory usage</em></strong></p>
<ol>
<li>
<p>sort by ID</p>
<pre><code>$ echo -e "&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAA" \
    | seqkit sort --quiet
&gt;SEQ2
acgtnAAAA
&gt;seq1
ACGTNcccc
</code></pre>
</li>
<li>
<p>sort by ID and in natural order</p>
<pre><code>$ echo -e "&gt;3\na\n&gt;1\na\n&gt;Y\na\n&gt;x\na\n&gt;Mt\na\n&gt;11\na\n&gt;2\na\n" \
    | seqkit seq -n -i
3
1
Y
x
Mt
11
2

$ echo -e "&gt;3\na\n&gt;1\na\n&gt;Y\na\n&gt;x\na\n&gt;Mt\na\n&gt;11\na\n&gt;2\na\n" \
    | seqkit sort -N -i -2 \
    | seqkit seq -n -i
1
2
3
11
Mt
x
Y
</code></pre>
</li>
<li>
<p>sort by ID, ignoring case.</p>
<pre><code>$ echo -e "&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAA" \
    | seqkit sort --quiet -i
&gt;seq1
ACGTNcccc
&gt;SEQ2
acgtnAAAA
</code></pre>
</li>
<li>
<p>sort by seq, ignoring case.</p>
<pre><code>$ echo -e "&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAA" \
    | seqkit sort --quiet -s -i
&gt;SEQ2
acgtnAAAA
&gt;seq1
ACGTNcccc
</code></pre>
</li>
<li>
<p>sort by sequence length</p>
<pre><code>$ echo -e "&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAAnnn\n&gt;seq3\nacgt" \
    | seqkit sort --quiet -l
&gt;seq3
acgt
&gt;seq1
ACGTNcccc
&gt;SEQ2
acgtnAAAAnnn
</code></pre>
</li>
</ol>
<h2 id="bam">bam</h2>
<pre><code class="text">monitoring and online histograms of BAM record features

Usage:
  seqkit bam [flags]

Flags:
  -B, --bins int             number of histogram bins (default -1)
  -c, --count string         count reads per reference and save to this file
  -W, --delay int            sleep this many seconds after plotting (default 1)
  -y, --dump                 print histogram data to stderr instead of plotting
  -e, --exec-after string    execute command after reporting
  -E, --exec-before string   execute command before reporting
  -f, --field string         target fields
  -h, --help                 help for bam
  -C, --idx-count            fast read per reference counting based on the BAM index
  -i, --idx-stat             fast statistics based on the BAM index
  -O, --img string           save histogram to this PDF/image file
  -H, --list-fields          list all available BAM record features
  -L, --log                  log10(x+1) transform numeric values
  -q, --map-qual int         minimum mapping quality
  -x, --pass                 passthrough mode (forward filtered BAM to output)
  -F, --prim-only            filter out non-primary alignment records
  -p, --print-freq int       print/report after this many records (-1 for print after EOF) (default -1)
  -Q, --quiet-mode           supress all plotting to stderr
  -M, --range-max float      discard record with field (-f) value greater than this flag (default NaN)
  -m, --range-min float      discard record with field (-f) value less than this flag (default NaN)
  -R, --reset                reset histogram after every report
  -s, --stat                 print BAM satistics of the input files
  -@, --top-bam string       save the top -? records to this bam file
  -?, --top-size int         size of the top-mode buffer (default 100)

Global Flags:
      --alphabet-guess-seq-length int   length of sequence prefix of the first FASTA record based on which seqkit guesses the sequence type (0 for whole seq) (default 10000)
      --id-ncbi                         FASTA head is NCBI-style, e.g. &gt;gi|110645304|ref|NC_002516.2| Pseud...
      --id-regexp string                regular expression for parsing ID (default &quot;^(\\S+)\\s?&quot;)
  -w, --line-width int                  line width when outputing FASTA format (0 for no wrap) (default 60)
  -o, --out-file string                 out file (&quot;-&quot; for stdout, suffix .gz for gzipped out) (default &quot;-&quot;)
      --quiet                           be quiet and do not show extra information
  -t, --seq-type string                 sequence type (dna|rna|protein|unlimit|auto) (for auto, it automatically detect by the first sequence) (default &quot;auto&quot;)
  -j, --threads int                     number of CPUs. (default value: 1 for single-CPU PC, 2 for others) (default 2)
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Get detailed statistics from multiple BAM files.</p>
<p>seqkit bam -s *.bam</p>
</li>
<li>
<p>Get rough statistics from multiple indexed BAM files.</p>
<p>seqkit bam -i *.bam</p>
</li>
<li>
<p>Count reads mapped to references from a BAM stream.</p>
<p>cat sample.bam | seqkit bam -c counts.tsv  -</p>
</li>
<li>
<p>Count reads mapped to references using the BAM index.</p>
<p>seqkit bam -C sorted_indexed.bam</p>
</li>
<li>
<p>Monitor alignment accuracy from a bam stream and report after every 1000 records, use 20 bins.</p>
<p>cat sample.bam | seqkit bam -B -f Acc -p 1000 - </p>
</li>
<li>
<p>Dump selected fields to TSV.</p>
<p>seqkit bam -f Ref,Acc,RefCov,Strand sample.bam</p>
</li>
<li>
<p>Save the best 100 records in terms of alignment accuracy to a BAM file.</p>
<p>seqkit bam -f Acc -@ top_acc_100.bam -? 100 -Q sample.bam</p>
</li>
</ol>
<h2 id="fish_1">fish</h2>
<pre><code class="text">look for short sequences in larger sequences using local alignment

Usage:
  seqkit fish [flags]

Flags:
  -a, --all                       search all
  -p, --aln-params string         alignment parameters in format &quot;&lt;match&gt;,&lt;mismatch&gt;,&lt;gap_open&gt;,&lt;gap_extend&gt;&quot; (default &quot;4,-4,-2,-1&quot;)
  -h, --help                      help for fish
  -i, --invert                    print out references not matching with any query
  -q, --min-qual float            minimum mapping quality (default 5)
  -b, --out-bam string            save aligmnets to this BAM file (memory intensive)
  -x, --pass                      pass through mode (write input to stdout)
  -g, --print-aln                 print sequence alignments
  -D, --print-desc                print full sequence header
  -f, --query-fastx string        query fasta
  -F, --query-sequences string    query sequences
  -r, --ranges string             target ranges, for example: &quot;:10,30:40,-20:&quot;
  -s, --stranded                  search + strand only
  -v, --validate-seq              validate bases according to the alphabet
  -V, --validate-seq-length int   length of sequence to validate (0 for whole seq) (default 10000)

Global Flags:
      --alphabet-guess-seq-length int   length of sequence prefix of the first FASTA record based on which seqkit guesses the sequence type (0 for whole seq) (default 10000)
      --id-ncbi                         FASTA head is NCBI-style, e.g. &gt;gi|110645304|ref|NC_002516.2| Pseud...
      --id-regexp string                regular expression for parsing ID (default &quot;^(\\S+)\\s?&quot;)
  -w, --line-width int                  line width when outputing FASTA format (0 for no wrap) (default 60)
  -o, --out-file string                 out file (&quot;-&quot; for stdout, suffix .gz for gzipped out) (default &quot;-&quot;)
      --quiet                           be quiet and do not show extra information
  -t, --seq-type string                 sequence type (dna|rna|protein|unlimit|auto) (for auto, it automatically detect by the first sequence) (default &quot;auto&quot;)
  -j, --threads int                     number of CPUs. (default value: 1 for single-CPU PC, 2 for others) (default 2)
</code></pre>

<p>Examples</p>
<ol>
<li>Find best local alignment of a short sequence in reads in a fasta file, print results as tabular</li>
</ol>
<p>seqkit fish -q 4.7 -F "GGCGGCTGTGACC" -g mouse-p53-cds.fna</p>
<ol>
<li>Find all local alignment of a short sequences in reads in a fasta file, print results as tabular and save as BAM</li>
</ol>
<p>seqkit fish -a -q 4.67 -f query.fas -b alignments.bam -g mouse-p53-cds.fna</p>
<h2 id="sana_1">sana</h2>
<pre><code class="text">sanitize broken single line fastq files

Usage:
  seqkit sana [flags]

Flags:
  -h, --help                  help for sana
  -b, --qual-ascii-base int   ASCII BASE, 33 for Phred+33 (default 33)

Global Flags:
      --alphabet-guess-seq-length int   length of sequence prefix of the first FASTA record based on which seqkit guesses the sequence type (0 for whole seq) (default 10000)
      --id-ncbi                         FASTA head is NCBI-style, e.g. &gt;gi|110645304|ref|NC_002516.2| Pseud...
      --id-regexp string                regular expression for parsing ID (default &quot;^(\\S+)\\s?&quot;)
  -w, --line-width int                  line width when outputing FASTA format (0 for no wrap) (default 60)
  -o, --out-file string                 out file (&quot;-&quot; for stdout, suffix .gz for gzipped out) (default &quot;-&quot;)
      --quiet                           be quiet and do not show extra information
  -t, --seq-type string                 sequence type (dna|rna|protein|unlimit|auto) (for auto, it automatically detect by the first sequence) (default &quot;auto&quot;)
  -j, --threads int                     number of CPUs. (default value: 1 for single-CPU PC, 2 for others) (default 2)
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Rescue usable reads from fastq file with malformed records.</p>
<p>seqkit sana broken.fq &gt; rescued.fq</p>
</li>
</ol>
<h2 id="watch_1">watch</h2>
<pre><code class="text">monitoring and online histograms of sequence features

Usage:
  seqkit watch [flags]

Flags:
  -B, --bins int                  number of histogram bins (default -1)
  -W, --delay int                 sleep this many seconds after online plotting (default 1)
  -y, --dump                      print histogram data to stderr instead of plotting
  -f, --fields string             target fields (default &quot;ReadLen&quot;)
  -h, --help                      help for watch
  -O, --img string                save histogram to this PDF/image file
  -H, --list-fields               print out a list of available fields
  -L, --log                       log10(x+1) transform numeric values
  -x, --pass                      pass through mode (write input to stdout)
  -p, --print-freq int            print/report after this many records (-1 for print after EOF) (default -1)
  -b, --qual-ascii-base int       ASCII BASE, 33 for Phred+33 (default 33)
  -Q, --quiet-mode                supress all plotting to stderr
  -R, --reset                     reset histogram after every report
  -v, --validate-seq              validate bases according to the alphabet
  -V, --validate-seq-length int   length of sequence to validate (0 for whole seq) (default 10000)

Global Flags:
      --alphabet-guess-seq-length int   length of sequence prefix of the first FASTA record based on which seqkit guesses the sequence type (0 for whole seq) (default 10000)
      --id-ncbi                         FASTA head is NCBI-style, e.g. &gt;gi|110645304|ref|NC_002516.2| Pseud...
      --id-regexp string                regular expression for parsing ID (default &quot;^(\\S+)\\s?&quot;)
  -w, --line-width int                  line width when outputing FASTA format (0 for no wrap) (default 60)
  -o, --out-file string                 out file (&quot;-&quot; for stdout, suffix .gz for gzipped out) (default &quot;-&quot;)
      --quiet                           be quiet and do not show extra information
  -t, --seq-type string                 sequence type (dna|rna|protein|unlimit|auto) (for auto, it automatically detect by the first sequence) (default &quot;auto&quot;)
  -j, --threads int                     number of CPUs. (default value: 1 for single-CPU PC, 2 for others) (default 2)
</code></pre>

<p>Examples</p>
<ol>
<li>
<p>Histogram of log sequence length</p>
<p>seqkit watch -L -f ReadLen hairpin.fa </p>
</li>
<li>
<p>Histogram of mean base qualities every 500 record, also saved as PDF</p>
<p>seqkit watch -p 500 -O qhist.pdf -f MeanQual reads_1.fq.gz</p>
</li>
</ol>
<h2 id="genautocomplete">genautocomplete</h2>
<p>Usage</p>
<pre><code class="text">generate shell autocompletion script

Note: The current version supports Bash only.
This should work for *nix systems with Bash installed.

Howto:

1. run: seqkit genautocomplete

2. create and edit ~/.bash_completion file if you don't have it.

        nano ~/.bash_completion

   add the following:

        for bcfile in ~/.bash_completion.d/* ; do
          . $bcfile
        done

Usage:
  seqkit genautocomplete [flags]

Flags:
      --file string   autocompletion file (default &quot;/home/shenwei/.bash_completion.d/seqkit.sh&quot;)
  -h, --help          help for genautocomplete
      --type string   autocompletion type (currently only bash supported) (default &quot;bash&quot;)

</code></pre>

<div id="disqus_thread"></div>

<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//seqkit.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../download/" title="Download" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Download
              </span>
            </div>
          </a>
        
        
          <a href="../faq/" title="FAQ" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                FAQ
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>